#include "activation.h"

namespace azah {
namespace nn {
namespace {

struct LinearSegment {
  const float m;
  const float b;
};

// Start of LUTs.
//
// Most of the LUT digits get truncated, but they're here for completeness.
//

// Swish:

constexpr LinearSegment kSwishLut255[] = {
    {.m = 0, .b = 0},
    {.m = -0.05682280886096453, .b = -0.45458247088771625},
    {.m = 0.012037318575193329, .b = 0.09199479063678676},
    {.m = -0.006587987276967015, .b = -0.05467949294897594},
    {.m = -0.0017815376048167728, .b = -0.017129104885302178},
    {.m = -0.003263185841727155, .b = -0.028611878721357637},
    {.m = -0.00307022268431964, .b = -0.027128474448787365},
    {.m = -0.003336705315269667, .b = -0.029160404509781322},
    {.m = -0.0034913667308203306, .b = -0.030330031464883216},
    {.m = -0.003687833415232905, .b = -0.031803531597977525},
    {.m = -0.003885528352494838, .b = -0.03327388769386315},
    {.m = -0.004095935317205368, .b = -0.03482563905860331},
    {.m = -0.0043166161608614445, .b = -0.03643936772783837},
    {.m = -0.004548890649148762, .b = -0.038123357767921424},
    {.m = -0.004793100577624304, .b = -0.03987861662883938},
    {.m = -0.005049879404665197, .b = -0.04170816577150574},
    {.m = -0.005319813087338324, .b = -0.043614572405384695},
    {.m = -0.00560353178510084, .b = -0.04560060328972232},
    {.m = -0.00590168619762492, .b = -0.047669049526608116},
    {.m = -0.006214954739702322, .b = -0.049822770753390255},
    {.m = -0.006544042450817508, .b = -0.05206468078536246},
    {.m = -0.0068896820667666, .b = -0.05439774819301883},
    {.m = -0.007252634473053604, .b = -0.056824992410063176},
    {.m = -0.007633689264055388, .b = -0.05934948040044999},
    {.m = -0.008033665205603613, .b = -0.06197432251686022},
    {.m = -0.00845341064671834, .b = -0.06470266788410595},
    {.m = -0.008893803846249049, .b = -0.06753769910608488},
    {.m = -0.009355753219569718, .b = -0.07048262636100415},
    {.m = -0.009840197474129397, .b = -0.07354068071791212},
    {.m = -0.010348105638175176, .b = -0.07671510674319823},
    {.m = -0.01088047694575267, .b = -0.08000915420883399},
    {.m = -0.01143834058027754, .b = -0.08342606897029882},
    {.m = -0.0120227552373742, .b = -0.0869690828289473},
    {.m = -0.012634808502294953, .b = -0.09064140241847184},
    {.m = -0.013275616002857205, .b = -0.0944461969530602},
    {.m = -0.013946320323094175, .b = -0.0983865848344524},
    {.m = -0.014648089642206596, .b = -0.10246561900179335},
    {.m = -0.015382116065223161, .b = -0.1066862709341386},
    {.m = -0.016149613622066794, .b = -0.11105141328868676},
    {.m = -0.01695181587769129, .b = -0.11556380097657455},
    {.m = -0.017789973136158876, .b = -0.1202260507268005},
    {.m = -0.01866534916752305, .b = -0.12504061889930346},
    {.m = -0.019579217435418017, .b = -0.13000977760598234},
    {.m = -0.020532856745327677, .b = -0.13513558889674676},
    {.m = -0.021527546283000354, .b = -0.14041987706563286},
    {.m = -0.022564559953772656, .b = -0.14586419883718743},
    {.m = -0.023645159982405517, .b = -0.15146981148572042},
    {.m = -0.0247705896744142, .b = -0.1572376386572649},
    {.m = -0.025942065286085225, .b = -0.16316823394134947},
    {.m = -0.027160766895857558, .b = -0.16926174199021113},
    {.m = -0.028427828209826478, .b = -0.17551785722793267},
    {.m = -0.029744325178913678, .b = -0.18193577995223278},
    {.m = -0.03111126335948966, .b = -0.1885141699462547},
    {.m = -0.03252956386470618, .b = -0.19525109734603316},
    {.m = -0.03400004784067434, .b = -0.20214399098338393},
    {.m = -0.035523419292363245, .b = -0.2091895839474451},
    {.m = -0.037100246184117336, .b = -0.21638385664107312},
    {.m = -0.03873093962589025, .b = -0.22372197712905123},
    {.m = -0.04041573105805596, .b = -0.23119823910928658},
    {.m = -0.042154647235860376, .b = -0.2388059973871809},
    {.m = -0.04394748291262063, .b = -0.2465376012432095},
    {.m = -0.04579377102637083, .b = -0.2543843257266479},
    {.m = -0.04769275025666753, .b = -0.26233630125351526},
    {.m = -0.049643329800428626, .b = -0.2703824418715298},
    {.m = -0.05164405117168802, .b = -0.27851037244227106},
    {.m = -0.05369304694133148, .b = -0.28670635552084495},
    {.m = -0.05578799619356234, .b = -0.29495521820150394},
    {.m = -0.05792607663009752, .b = -0.3032402798930778},
    {.m = -0.06010391317182373, .b = -0.31154328170840895},
    {.m = -0.062317522947952675, .b = -0.3198443183688925},
    {.m = -0.06456225662722304, .b = -0.32812177381120194},
    {.m = -0.06683273603118156, .b = -0.3363522616505516},
    {.m = -0.06912278800353433, .b = -0.34451057180205835},
    {.m = -0.07142537463957277, .b = -0.3525696250281929},
    {.m = -0.07373251989218743, .b = -0.36050043683405575},
    {.m = -0.07603523280775559, .b = -0.36827209292409835},
    {.m = -0.07832342757820787, .b = -0.37585173810122147},
    {.m = -0.08058584076902253, .b = -0.3832045809713691},
    {.m = -0.08280994620857696, .b = -0.39029391705994887},
    {.m = -0.084981868019534, .b = -0.39708117271918963},
    {.m = -0.08708629263769119, .b = -0.403525973112296},
    {.m = -0.08910638051285513, .b = -0.4095862367377878},
    {.m = -0.09102367872548456, .b = -0.4152183002373868},
    {.m = -0.09281803553948142, .b = -0.42037707607762775},
    {.m = -0.09446751854157842, .b = -0.4250162470210256},
    {.m = -0.09594833781166878, .b = -0.4290885000137741},
    {.m = -0.09723477623706289, .b = -0.43254580328202075},
    {.m = -0.09829912890293802, .b = -0.43533972902994295},
    {.m = -0.09911165416930201, .b = -0.4374218250250007},
    {.m = -0.0996405389081163, .b = -0.43874403687203645},
    {.m = -0.09985188095426922, .b = -0.43925918310953416},
    {.m = -0.09970969187275847, .b = -0.4389214840409461},
    {.m = -0.099175923371281, .b = -0.4376871443812795},
    {.m = -0.09821052105157246, .b = -0.43551498916193526},
    {.m = -0.09677150901237574, .b = -0.43236715032619244},
    {.m = -0.09481510928140269, .b = -0.4282098008978747},
    {.m = -0.09229589962618068, .b = -0.4230139309839793},
    {.m = -0.08916701361777957, .b = -0.4167561589671771},
    {.m = -0.08538038616494914, .b = -0.4094195682773181},
    {.m = -0.08088704781222322, .b = -0.40099455886595703},
    {.m = -0.07563747013363731, .b = -0.39147969932352006},
    {.m = -0.06958196432953212, .b = -0.380882564166336},
    {.m = -0.06267113378342248, .b = -0.36922053761977597},
    {.m = -0.05485638069163823, .b = -0.35652156384562655},
    {.m = -0.04609046536426842, .b = -0.3428248211466112},
    {.m = -0.03632811527485291, .b = -0.32818129601248797},
    {.m = -0.025526679694559462, .b = -0.31265423236581613},
    {.m = -0.01364682330105449, .b = -0.2963194298247468},
    {.m = -0.0006532510352581511, .b = -0.2792653662258891},
    {.m = 0.013484546332771075, .b = -0.26159311951585257},
    {.m = 0.028791537585721727, .b = -0.24341606740297367},
    {.m = 0.045286401768176, .b = -0.2248593451977126},
    {.m = 0.0629807995822862, .b = -0.20605904752022053},
    {.m = 0.0818786827177922, .b = -0.18716116438471453},
    {.m = 0.10197566018650495, .b = -0.16832024800779632},
    {.m = 0.1232584364160707, .b = -0.14969781880692629},
    {.m = 0.14570435658614977, .b = -0.13146050866873704},
    {.m = 0.16928101492193814, .b = -0.11377801491689576},
    {.m = 0.19394617817781956, .b = -0.09682071517847729},
    {.m = 0.2196471610807551, .b = -0.08075760086414258},
    {.m = 0.24632294572603364, .b = -0.0657524720011734},
    {.m = 0.273896812846238, .b = -0.05196553844107121},
    {.m = 0.30230517799251455, .b = -0.03953687868957523},
    {.m = 0.33139211556106574, .b = -0.028629277101368533},
    {.m = 0.361305968483155, .b = -0.01928119806321564},
    {.m = 0.3910228798418154, .b = -0.011851970223550543},
    {.m = 0.42386167235318506, .b = -0.0056946966276687355},
    {.m = 0.44690663081635373, .b = -0.0028140768197726443},
    {.m = 0.5000000000000007, .b = 0.000504258754205289},
    {.m = 0.5530933691836433, .b = -0.0028140768197723737},
    {.m = 0.5761383276468144, .b = -0.005694696627668763},
    {.m = 0.6089771201581924, .b = -0.011851970223552138},
    {.m = 0.6386940315168341, .b = -0.019281198063212573},
    {.m = 0.6686078844389396, .b = -0.02862927710137053},
    {.m = 0.6976948220075503, .b = -0.03953687868959954},
    {.m = 0.7261031871536003, .b = -0.05196553844099644},
    {.m = 0.7536770542742044, .b = -0.06575247200129847},
    {.m = 0.7803528389188719, .b = -0.08075760086392392},
    {.m = 0.8060538218227968, .b = -0.09682071517887703},
    {.m = 0.8307189850763503, .b = -0.11377801491569506},
    {.m = 0.8542956434170836, .b = -0.13146050867124504},
    {.m = 0.8767415635807971, .b = -0.14969781880426225},
    {.m = 0.8980243398143344, .b = -0.16832024800860734},
    {.m = 0.9181213172863121, .b = -0.18716116438858643},
    {.m = 0.9370192004096562, .b = -0.2060590475119306},
    {.m = 0.9547135982409074, .b = -0.22485934520763495},
    {.m = 0.9712084624050412, .b = -0.2434160673922855},
    {.m = 0.9865154536748051, .b = -0.2615931195251301},
    {.m = 1.00065325103448, .b = -0.27926536622472387},
    {.m = 1.013646823294419, .b = -0.29631942981589354},
    {.m = 1.0255266797037663, .b = -0.31265423237874623},
    {.m = 1.0363281152649435, .b = -0.32818129599793844},
    {.m = 1.0460904653744088, .b = -0.3428248211621363},
    {.m = 1.0548563806812759, .b = -0.35652156382911615},
    {.m = 1.0626711337944457, .b = -0.3692205376380171},
    {.m = 1.0695819643161002, .b = -0.3808825641433091},
    {.m = 1.0756374701493705, .b = -0.39147969935153215},
    {.m = 1.0808870477964518, .b = -0.4009945588368671},
    {.m = 1.0853803861801694, .b = -0.4094195683063375},
    {.m = 1.0891670136031024, .b = -0.4167561589382702},
    {.m = 1.092295899639236, .b = -0.4230139310105374},
    {.m = 1.0948151092743004, .b = -0.42820980088285765},
    {.m = 1.0967715090082457, .b = -0.4323671503174915},
    {.m = 1.0982105210676245, .b = -0.4355149891973824},
    {.m = 1.0991759233484046, .b = -0.4376871443291379},
    {.m = 1.0997096918974876, .b = -0.4389214840988922},
    {.m = 1.0998518809289592, .b = -0.4392591830486374},
    {.m = 1.0996405389338975, .b = -0.4387440369356743},
    {.m = 1.099111654142348, .b = -0.4374218249568007},
    {.m = 1.0982991289307193, .b = -0.43533972910200225},
    {.m = 1.0972347762103922, .b = -0.43254580321114355},
    {.m = 1.0959483378330575, .b = -0.42908850007205634},
    {.m = 1.0944675185399788, .b = -0.4250162470160901},
    {.m = 1.09281803552134, .b = -0.42037707602616825},
    {.m = 1.0910236787489112, .b = -0.4152183003054355},
    {.m = 1.089106380488012, .b = -0.4095862366640439},
    {.m = 1.0870862926629172, .b = -0.40352597318875993},
    {.m = 1.084981867994209, .b = -0.39708117264084075},
    {.m = 1.0828099462339154, .b = -0.39029391713992334},
    {.m = 1.0805858407437299, .b = -0.3832045808899571},
    {.m = 1.0783234276024487, .b = -0.3758517381807933},
    {.m = 1.0760352327885272, .b = -0.3682720928596783},
    {.m = 1.073732519892431, .b = -0.3605004368353537},
    {.m = 1.07142537465851, .b = -0.35256962509375045},
    {.m = 1.0691227879792677, .b = -0.3445105717164023},
    {.m = 1.0668327360568952, .b = -0.3363522617429502},
    {.m = 1.0645622566010644, .b = -0.3281217737155635},
    {.m = 1.0623175229744533, .b = -0.3198443184674349},
    {.m = 1.0601039131446797, .b = -0.31154328160578393},
    {.m = 1.057926076657786, .b = -0.3032402799995024},
    {.m = 1.0557879961657264, .b = -0.2949552180927708},
    {.m = 1.0536930469693004, .b = -0.28670635563184366},
    {.m = 1.0516440511416505, .b = -0.27851037232124387},
    {.m = 1.0496433298402081, .b = -0.2703824420341343},
    {.m = 1.0476927502070197, .b = -0.26233630104723193},
    {.m = 1.0457937710786922, .b = -0.2543843259473606},
    {.m = 1.0439474828599629, .b = -0.2465376010177609},
    {.m = 1.0421546472862104, .b = -0.23880599760595356},
    {.m = 1.0404157310181148, .b = -0.23119823893303515},
    {.m = 1.0387309396262765, .b = -0.22372197713175268},
    {.m = 1.0371002462233037, .b = -0.2163838568183749},
    {.m = 1.0355234192426224, .b = -0.20918958371901653},
    {.m = 1.0340000478930733, .b = -0.20214399122735216},
    {.m = 1.0325295638122327, .b = -0.19525109709841182},
    {.m = 1.0311112634095707, .b = -0.18851417018576733},
    {.m = 1.0297443251384522, .b = -0.18193577975600927},
    {.m = 1.0284278282142196, .b = -0.17551785725037572},
    {.m = 1.0271607669308338, .b = -0.1692617421636582},
    {.m = 1.0259420652379134, .b = -0.1631682336990563},
    {.m = 1.02477058972363, .b = -0.15723763890799702},
    {.m = 1.0236451599419922, .b = -0.1514698112771029},
    {.m = 1.0225645599575728, .b = -0.145864198857927},
    {.m = 1.0215275463149425, .b = -0.14041987723411786},
    {.m = 1.0205328567152634, .b = -0.13513558873582276},
    {.m = 1.019579217429154, .b = -0.13000977757298493},
    {.m = 1.0186653492089732, .b = -0.12504061912575182},
    {.m = 1.0177899730853, .b = -0.1202260504455488},
    {.m = 1.016951815931023, .b = -0.11556380127488275},
    {.m = 1.0161496135682597, .b = -0.11105141298433985},
    {.m = 1.0153821161184453, .b = -0.10668627123852037},
    {.m = 1.0146480895917875, .b = -0.10246561871023818},
    {.m = 1.0139463203628907, .b = -0.09838658506727516},
    {.m = 1.0132756160027583, .b = -0.09444619695149736},
    {.m = 1.0126348084626642, .b = -0.09064140218218864},
    {.m = 1.0120227552876742, .b = -0.08696908313224849},
    {.m = 1.011438340527107, .b = -0.08342606864631019},
    {.m = 1.0108804769997022, .b = -0.08000915454095558},
    {.m = 1.0103481055840149, .b = -0.07671510640639045},
    {.m = 1.0098401975283195, .b = -0.07354068105829459},
    {.m = 1.0093557531655506, .b = -0.07048262601831556},
    {.m = 1.0088938038995678, .b = -0.06753769944767551},
    {.m = 1.008453410596033, .b = -0.06470266755616993},
    {.m = 1.0080336652464865, .b = -0.06197432278411785},
    {.m = 1.0076336892596771, .b = -0.05934948037068111},
    {.m = 1.0072526344379753, .b = -0.05682499217690662},
    {.m = 1.0068896821149025, .b = -0.05439774851635715},
    {.m = 1.0065440424015861, .b = -0.05206468045147172},
    {.m = 1.0062149547800345, .b = -0.04982277102965149},
    {.m = 1.0059016861941075, .b = -0.04766904950140294},
    {.m = 1.0056035316500385, .b = -0.0456006023519242},
    {.m = 1.0053198137403143, .b = -0.04361457698385518},
    {.m = 1.0050498768177079, .b = -0.04170814746794704},
    {.m = 1.00479311038454, .b = -0.03987868663162608},
    {.m = 1.0045488538922882, .b = -0.03812309309356632},
    {.m = 1.0043167535063162, .b = -0.036440365295269395},
    {.m = 1.0040954225471097, .b = -0.03482188265607178},
    {.m = 1.0038874422848494, .b = -0.03328802822190191},
    {.m = 1.0036806900947113, .b = -0.03175030880774976},
    {.m = 1.0035180270155308, .b = -0.030530335713896406},
    {.m = 1.0032372046555622, .b = -0.028406616616633684},
    {.m = 1.003441574636227, .b = -0.029964937719203277},
    {.m = 1.001877244144481, .b = -0.017939147063905203},
    {.m = 1.0069540799101873, .b = -0.05728462424812886},
    {.m = 0.9872832856269724, .b = 0.09639345608948702},
    {.m = 1.0600107135696817, .b = -0.47633503895934837},
    {.m = 1.0, .b = 0}};

constexpr LinearSegment kSwishDLut255[] = {
    {.m = 0, .b = 0},
    {.m = -0.049655914804101614, .b = -0.3972473184328129},
    {.m = 0.010580252926040618, .b = 0.08087726292519105},
    {.m = -0.0057043303752583666, .b = -0.04736383057253845},
    {.m = -0.0014931085218340134, .b = -0.01446365984266069},
    {.m = -0.00278124269398939, .b = -0.02444669967686486},
    {.m = -0.0026038894732303766, .b = -0.023083296792279943},
    {.m = -0.002827590923467481, .b = -0.024789020350337865},
    {.m = -0.0029526040154130642, .b = -0.025734431858176338},
    {.m = -0.0031132262461713994, .b = -0.02693909858886385},
    {.m = -0.0032738839060423366, .b = -0.028133989934153947},
    {.m = -0.0034445328229376626, .b = -0.029392525696256975},
    {.m = -0.0036229443805246286, .b = -0.030697160211111664},
    {.m = -0.0038101690444972136, .b = -0.032054539024912905},
    {.m = -0.004006393367550459, .b = -0.03346490134685811},
    {.m = -0.0042120498200260426, .b = -0.03493020357074664},
    {.m = -0.004427519390501677, .b = -0.03645195741223081},
    {.m = -0.004653210996375237, .b = -0.03803179865334573},
    {.m = -0.00488953992231371, .b = -0.03967133057704389},
    {.m = -0.005136933161785026, .b = -0.04137215909840918},
    {.m = -0.005395827453917437, .b = -0.043135876463561235},
    {.m = -0.0056666691305799766, .b = -0.04496405778103337},
    {.m = -0.005949913335033988, .b = -0.046858253398319574},
    {.m = -0.006246023238602155, .b = -0.04881998150945868},
    {.m = -0.006555469071297976, .b = -0.05085071978652501},
    {.m = -0.0068787269971904985, .b = -0.052951896304826405},
    {.m = -0.007216277797420539, .b = -0.055124879581307296},
    {.m = -0.007568605354571045, .b = -0.057370967758141767},
    {.m = -0.007936194902512322, .b = -0.05969137677952108},
    {.m = -0.008319531033242678, .b = -0.062087227596585796},
    {.m = -0.008719095418704248, .b = -0.06455953223162927},
    {.m = -0.009135364235634352, .b = -0.06710917873532615},
    {.m = -0.009568805247237383, .b = -0.06973691486816952},
    {.m = -0.010019874523120476, .b = -0.07244333052346809},
    {.m = -0.010489012748010867, .b = -0.07522883873375479},
    {.m = -0.010976641091970607, .b = -0.07809365525451825},
    {.m = -0.01148315659178728, .b = -0.08103777659720267},
    {.m = -0.01200892700066164, .b = -0.08406095644823024},
    {.m = -0.012554285061607218, .b = -0.08716268041985821},
    {.m = -0.013119522140700446, .b = -0.09034213898975763},
    {.m = -0.013704881180494177, .b = -0.09359819864861024},
    {.m = -0.014310548891660002, .b = -0.09692937106002228},
    {.m = -0.014936647142450132, .b = -0.10033378029869362},
    {.m = -0.015583223450807482, .b = -0.10380912795611437},
    {.m = -0.016250240532372062, .b = -0.10735265620192622},
    {.m = -0.016937564799533456, .b = -0.11096110860452352},
    {.m = -0.017644953755986903, .b = -0.11463068881612579},
    {.m = -0.0183720421737546, .b = -0.11835701695718522},
    {.m = -0.01911832698665422, .b = -0.12213508382248955},
    {.m = -0.019883150783072068, .b = -0.12595920280457878},
    {.m = -0.02066568381901862, .b = -0.1298229596695649},
    {.m = -0.021464904431572507, .b = -0.1337191601557651},
    {.m = -0.022279577769327596, .b = -0.13763977559371146},
    {.m = -0.02310823270974538, .b = -0.14157588656069592},
    {.m = -0.0239491368881386, .b = -0.14551762489691417},
    {.m = -0.024800269696861776, .b = -0.14945411413725884},
    {.m = -0.025659293196579225, .b = -0.1533734088547197},
    {.m = -0.026523520793845123, .b = -0.15726243304241624},
    {.m = -0.02738988364750017, .b = -0.1611069182055105},
    {.m = -0.028254894672950948, .b = -0.16489134144185766},
    {.m = -0.029114610128643803, .b = -0.1685988643445331},
    {.m = -0.029964588698142558, .b = -0.17221127326490282},
    {.m = -0.030799848067828428, .b = -0.1757089218754624},
    {.m = -0.03161481900618024, .b = -0.1790706769961636},
    {.m = -0.03240329696289901, .b = -0.18227386869533363},
    {.m = -0.03315839131077247, .b = -0.18529424608682749},
    {.m = -0.03387247232395796, .b = -0.18810594007624531},
    {.m = -0.0345371161245136, .b = -0.19068143480339844},
    {.m = -0.035143047850762055, .b = -0.19299154950972067},
    {.m = -0.0356800833969273, .b = -0.19500543280784033},
    {.m = -0.03613707019076107, .b = -0.19669057161010237},
    {.m = -0.03650182756723619, .b = -0.19801281709982466},
    {.m = -0.03676108740827666, .b = -0.19893643028353133},
    {.m = -0.03690043594032044, .b = -0.1994241501456846},
    {.m = -0.03690425761026428, .b = -0.19943728713611653},
    {.m = -0.03675568230268911, .b = -0.19893584547305032},
    {.m = -0.036436537216495646, .b = -0.19787867737503448},
    {.m = -0.035927305020345024, .b = -0.19622367273754496},
    {.m = -0.035207090150904286, .b = -0.1939279878412026},
    {.m = -0.03425359527092797, .b = -0.19094831634127662},
    {.m = -0.033043110334427084, .b = -0.18724120622324264},
    {.m = -0.0315505167835346, .b = -0.18276342557056519},
    {.m = -0.029749309892650455, .b = -0.17747238032859303},
    {.m = -0.027611642337646902, .b = -0.1713265861079578},
    {.m = -0.0251083925494624, .b = -0.16428619607868888},
    {.m = -0.02220926143777513, .b = -0.1563135855215489},
    {.m = -0.01888290149274252, .b = -0.14737399316927377},
    {.m = -0.015097082209851065, .b = -0.1374362175516837},
    {.m = -0.01081889607951747, .b = -0.12647336559270386},
    {.m = -0.006015009157167128, .b = -0.11446364828682801},
    {.m = -0.0006519603036492239, .b = -0.10139121670637812},
    {.m = 0.005303487273361496, .b = -0.08724702871097766},
    {.m = 0.011883938861957377, .b = -0.07202973441234968},
    {.m = 0.019120902867525658, .b = -0.05574656539982105},
    {.m = 0.02704426553129724, .b = -0.03841420957282071},
    {.m = 0.03568170508945179, .b = -0.0200596505117423},
    {.m = 0.04505804632134125, .b = -0.0007209467209702836},
    {.m = 0.05519455796315409, .b = 0.019552076562655396},
    {.m = 0.06610819771516407, .b = 0.04069725358217474},
    {.m = 0.07781081169990411, .b = 0.06263965480356232},
    {.m = 0.09030829807484242, .b = 0.085291348858138},
    {.m = 0.10359974716481335, .b = 0.10855138476558712},
    {.m = 0.11767657375752405, .b = 0.13230602964078642},
    {.m = 0.13252166016143463, .b = 0.1564292950471411},
    {.m = 0.1481085319707336, .b = 0.18078378224917077},
    {.m = 0.1644005913246704, .b = 0.20522187128007593},
    {.m = 0.18135043523327865, .b = 0.22958727189870032},
    {.m = 0.19889928867946227, .b = 0.2537169453872028},
    {.m = 0.21697658365208045, .b = 0.27744339503876414},
    {.m = 0.23549971584335677, .b = 0.3005973102778596},
    {.m = 0.25437401009148103, .b = 0.3230105346975071},
    {.m = 0.2734929237607885, .b = 0.34451931257547797},
    {.m = 0.29273851379383087, .b = 0.3649677519855855},
    {.m = 0.3119821882044167, .b = 0.38421142639617134},
    {.m = 0.33108575612834024, .b = 0.40212102132484967},
    {.m = 0.34990278234925065, .b = 0.4185859192681463},
    {.m = 0.36828024274647087, .b = 0.4335176058408877},
    {.m = 0.38606046606290034, .b = 0.44685277332820983},
    {.m = 0.40308333684703657, .b = 0.45855599699230354},
    {.m = 0.41918871978419103, .b = 0.468621861328025},
    {.m = 0.43421906434455737, .b = 0.4770764301432311},
    {.m = 0.4480221009418992, .b = 0.483977948441902},
    {.m = 0.46045366941142873, .b = 0.4894167596473212},
    {.m = 0.4713801965502622, .b = 0.4935142073243837},
    {.m = 0.4806822669342168, .b = 0.49642110431936953},
    {.m = 0.4882535203412832, .b = 0.49831391767113614},
    {.m = 0.4940160224831258, .b = 0.49939438682273163},
    {.m = 0.497872824627442, .b = 0.49987648709077115},
    {.m = 0.49984903117461554, .b = 0.49999999999996947},
    {.m = 0.49787282462991733, .b = 0.5001235129090131},
    {.m = 0.4940160224799879, .b = 0.5006056131777543},
    {.m = 0.4882535203445997, .b = 0.5016860823281396},
    {.m = 0.4806822669308488, .b = 0.5035788956815773},
    {.m = 0.4713801965536515, .b = 0.5064857926744515},
    {.m = 0.46045366940800747, .b = 0.510583240354068},
    {.m = 0.44802210094542794, .b = 0.5160220515564465},
    {.m = 0.4342190643406276, .b = 0.5229235698588467},
    {.m = 0.41918871978792893, .b = 0.5313781386697397},
    {.m = 0.4030833368461568, .b = 0.5414440030083473},
    {.m = 0.386060466060167, .b = 0.5531472266737153},
    {.m = 0.36828024275065374, .b = 0.5664823941558502},
    {.m = 0.34990278234540284, .b = 0.5814140807351166},
    {.m = 0.33108575613190183, .b = 0.59787897867193},
    {.m = 0.31198218819968204, .b = 0.615788573608386},
    {.m = 0.29273851380006377, .b = 0.6350322480080043},
    {.m = 0.27349292375382817, .b = 0.6554806874321296},
    {.m = 0.25437401009871685, .b = 0.6769894652941298},
    {.m = 0.23549971583553742, .b = 0.6994026897316554},
    {.m = 0.2169765836623263, .b = 0.7225566049481693},
    {.m = 0.19889928866669848, .b = 0.7462830546299308},
    {.m = 0.18135043524677386, .b = 0.7704127280823272},
    {.m = 0.16440059131092966, .b = 0.7947781287401032},
    {.m = 0.14810853198450502, .b = 0.8192162177297402},
    {.m = 0.1325216601479866, .b = 0.8435707049743002},
    {.m = 0.11767657377047414, .b = 0.867693970337758},
    {.m = 0.10359974715227693, .b = 0.8914486152559657},
    {.m = 0.09030829808666141, .b = 0.9147086511207929},
    {.m = 0.07781081169052939, .b = 0.9373603452137822},
    {.m = 0.06610819771548293, .b = 0.9593027464169943},
    {.m = 0.05519455797217887, .b = 0.9804479234196459},
    {.m = 0.045058046311051925, .b = 1.0007209467418998},
    {.m = 0.03568170509284485, .b = 1.020059650504452},
    {.m = 0.027044265537355727, .b = 1.0384142095598663},
    {.m = 0.019120902857604705, .b = 1.0557465654218217},
    {.m = 0.011883938870219879, .b = 1.0720297343934375},
    {.m = 0.005303487274552765, .b = 1.0872470287084177},
    {.m = -0.000651960313934552, .b = 1.101391216731075},
    {.m = -0.006015009144945793, .b = 1.114463648256665},
    {.m = -0.0108188960920792, .b = 1.1264733656244985},
    {.m = -0.015097082197197409, .b = 1.137436217518864},
    {.m = -0.018882901505421046, .b = 1.147373993202951},
    {.m = -0.022209261425093274, .b = 1.15631358548707},
    {.m = -0.02510839256214581, .b = 1.1642861961139646},
    {.m = -0.027611642324959718, .b = 1.1713265860718787},
    {.m = -0.02974930990533764, .b = 1.1774723803654652},
    {.m = -0.031550516770852965, .b = 1.1827634255329165},
    {.m = -0.033043110347094284, .b = 1.1872412062616404},
    {.m = -0.034253595258313396, .b = 1.190948316302249},
    {.m = -0.03520709016332901, .b = 1.1939279878804228},
    {.m = -0.03592730500862373, .b = 1.1962236726997997},
    {.m = -0.03643653722557971, .b = 1.1978786774049066},
    {.m = -0.036755682303354575, .b = 1.1989358454750358},
    {.m = -0.036904257600301804, .b = 1.1994372871022327},
    {.m = -0.03690043595231174, .b = 1.199424150187267},
    {.m = -0.036761087395770886, .b = 1.198936430239374},
    {.m = -0.0365018275799045, .b = 1.19801281714535},
    {.m = -0.036137070177961306, .b = 1.1966905715633058},
    {.m = -0.035680083410095875, .b = 1.195005432856802},
    {.m = -0.035143047837134844, .b = 1.1929915494581982},
    {.m = -0.03453711613834187, .b = 1.19068143485655},
    {.m = -0.033872472310171986, .b = 1.1881059400223917},
    {.m = -0.033158391324267456, .b = 1.1852942461403926},
    {.m = -0.0324032969496848, .b = 1.182273868642062},
    {.m = -0.03161481901932106, .b = 1.1790706770499593},
    {.m = -0.030799848054694934, .b = 1.1757089218208765},
    {.m = -0.02996458871131935, .b = 1.1722112733204912},
    {.m = -0.02911461011527905, .b = 1.16859886428732},
    {.m = -0.028254894686607912, .b = 1.1648913415011757},
    {.m = -0.027389883633713197, .b = 1.1611069181447613},
    {.m = -0.02652352080743725, .b = 1.1572624331031618},
    {.m = -0.025659293183895926, .b = 1.1533734087972258},
    {.m = -0.024800269706098277, .b = 1.149454114179774},
    {.m = -0.023949136878929522, .b = 1.1455176248541186},
    {.m = -0.023108232722293565, .b = 1.1415758866198875},
    {.m = -0.022279577756254554, .b = 1.1376397755312022},
    {.m = -0.021464904443618593, .b = 1.1337191602141417},
    {.m = -0.020665683811390778, .b = 1.129822959632031},
    {.m = -0.019883150780785286, .b = 1.1259592027934164},
    {.m = -0.01911832699711269, .b = 1.1221350838750535},
    {.m = -0.01837204216111843, .b = 1.1183570168928325},
    {.m = -0.017644953769131888, .b = 1.1146306888839015},
    {.m = -0.01693756478626085, .b = 1.110961108535258},
    {.m = -0.01625024054567703, .b = 1.107352656272193},
    {.m = -0.01558322343749552, .b = 1.1038091278849786},
    {.m = -0.014936647155760596, .b = 1.1003337803706534},
    {.m = -0.01431054887836325, .b = 1.0969293709873054},
    {.m = -0.01370488119374258, .b = 1.0935981987218917},
    {.m = -0.013119522127642114, .b = 1.0903421389167078},
    {.m = -0.012554285073946403, .b = 1.0871626804896695},
    {.m = -0.012008926990997537, .b = 1.0840609563928978},
    {.m = -0.011483156591594934, .b = 1.0810377765963328},
    {.m = -0.01097664110197627, .b = 1.0780936553129243},
    {.m = -0.010489012735448, .b = 1.0752288386595708},
    {.m = -0.01001987453629738, .b = 1.072443330602114},
    {.m = -0.009568805233943323, .b = 1.0697369147879896},
    {.m = -0.009135364248784583, .b = 1.0671091788154647},
    {.m = -0.008719095406245714, .b = 1.0645595321549142},
    {.m = -0.00831953104307459, .b = 1.0620872276577928},
    {.m = -0.007936194902470106, .b = 1.0596913767790148},
    {.m = -0.007568605344705048, .b = 1.0573709676956229},
    {.m = -0.007216277810062621, .b = 1.0551248796622774},
    {.m = -0.006878726983813976, .b = 1.0529518962183018},
    {.m = -0.006555469084869259, .b = 1.050850719875161},
    {.m = -0.006246023224960595, .b = 1.0488199814195105},
    {.m = -0.005949913348818114, .b = 1.0468582534900666},
    {.m = -0.00566666911625191, .b = 1.04496405768478},
    {.m = -0.005395827470383807, .b = 1.0431358765751704},
    {.m = -0.0051369331371340365, .b = 1.0413721589299063},
    {.m = -0.0048895399776860415, .b = 1.0396713309587013},
    {.m = -0.004653210826106147, .b = 1.0380317974696158},
    {.m = -0.004427520003435603, .b = 1.036451961710922},
    {.m = -0.00421204752347748, .b = 1.0349301873212178},
    {.m = -0.004006401971228257, .b = 1.033464962761442},
    {.m = -0.003810136892369087, .b = 1.0320543075071418},
    {.m = -0.0036230644270141, .b = 1.0306980321333181},
    {.m = -0.0034440847133367924, .b = 1.0293892429770528},
    {.m = -0.003275556445323957, .b = 1.0281463470004581},
    {.m = -0.003106983885224679, .b = 1.0268925885847198},
    {.m = -0.002975901727463537, .b = 1.0259094724015112},
    {.m = -0.0027406399810772086, .b = 1.0241303054444646},
    {.m = -0.0029284038987498207, .b = 1.0255620053167183},
    {.m = -0.0015701057491206427, .b = 1.015120088291444},
    {.m = -0.006013253260562124, .b = 1.0495544815051154},
    {.m = 0.011165525936124965, .b = 0.9153452690309976},
    {.m = -0.05238057244770644, .b = 1.4157707938036699},
    {.m = 0, .b = 1}};

// Sigmoid:

constexpr LinearSegment kSigmoidLut255[] = {
    {.m = 0, .b = 0},
    {.m = 0.0071468764945873025, .b = 0.05717501195669842},
    {.m = -0.0014541880875940652, .b = -0.011095938164366185},
    {.m = 0.0008800928444864633, .b = 0.007286524175767975},
    {.m = 0.00028624622326780657, .b = 0.00264709744749722},
    {.m = 0.00047900319333008413, .b = 0.0041409639654798715},
    {.m = 0.00046316162987578187, .b = 0.004019181946424923},
    {.m = 0.0005055172433562601, .b = 0.004342143499213569},
    {.m = 0.0005347322857199872, .b = 0.004563082257089255},
    {.m = 0.000570078671449618, .b = 0.004828180150061486},
    {.m = 0.0006065602415530977, .b = 0.0050995118277061165},
    {.m = 0.0006456939838433689, .b = 0.0053881231770968666},
    {.m = 0.0006872631253803923, .b = 0.00569209752458635},
    {.m = 0.0007315275451274493, .b = 0.006013014567752514},
    {.m = 0.0007786322750088469, .b = 0.006351579813775058},
    {.m = 0.000828766797662514, .b = 0.006708788287682437},
    {.m = 0.0008821232241602514, .b = 0.007085618049822708},
    {.m = 0.0009389084124974065, .b = 0.007483114368182792},
    {.m = 0.0009993416889623602, .b = 0.00790237022365841},
    {.m = 0.0010636564854654453, .b = 0.008344534449617119},
    {.m = 0.001132100990018172, .b = 0.00881081263688257},
    {.m = 0.0012049391266394614, .b = 0.009302470059076272},
    {.m = 0.0012824515164361304, .b = 0.009820834165841497},
    {.m = 0.0013649365162996842, .b = 0.01036729728993754},
    {.m = 0.0014527113133768546, .b = 0.010943319395756471},
    {.m = 0.0015461130856948904, .b = 0.011550430915823705},
    {.m = 0.001645500229390577, .b = 0.012190235653364688},
    {.m = 0.0017512536579056513, .b = 0.012864413760148286},
    {.m = 0.0018637781749179794, .b = 0.013574724773788606},
    {.m = 0.0019835039263614504, .b = 0.014323010720310302},
    {.m = 0.0021108879334210615, .b = 0.015111199263991643},
    {.m = 0.0022464157122570744, .b = 0.015941306909362223},
    {.m = 0.0023906029819544053, .b = 0.016815442231902292},
    {.m = 0.0025439974671569096, .b = 0.01773580914311732},
    {.m = 0.0027071807964987316, .b = 0.018704710161084385},
    {.m = 0.002880770502919662, .b = 0.019724549686307352},
    {.m = 0.003065422128354617, .b = 0.020797837259148026},
    {.m = 0.0032618314361760672, .b = 0.021927190779121367},
    {.m = 0.0034707367364979133, .b = 0.023115339674701866},
    {.m = 0.00369292132492207, .b = 0.02436512798458775},
    {.m = 0.003929216040856873, .b = 0.02567951734197509},
    {.m = 0.004180501944442902, .b = 0.027061589811698247},
    {.m = 0.004447713118178959, .b = 0.028514550568888058},
    {.m = 0.004731839590133, .b = 0.030041730355641026},
    {.m = 0.005033930385061058, .b = 0.03164658770369634},
    {.m = 0.005355096697366571, .b = 0.03333271084330028},
    {.m = 0.005696515191434617, .b = 0.03510381928127827},
    {.m = 0.006059431420792141, .b = 0.036963764956735576},
    {.m = 0.0064451633688718535, .b = 0.03891653294388912},
    {.m = 0.0068551051006831565, .b = 0.04096624160294564},
    {.m = 0.007290730523943703, .b = 0.04311714213029459},
    {.m = 0.0077535972453387225, .b = 0.045373617397095306},
    {.m = 0.00824535051679004, .b = 0.04774018001595477},
    {.m = 0.008767727250242635, .b = 0.0502214694998546},
    {.m = 0.009322560092923649, .b = 0.05282224844992185},
    {.m = 0.009911781531478342, .b = 0.055547397603237306},
    {.m = 0.010537428012470373, .b = 0.05840190967276345},
    {.m = 0.011201644036940017, .b = 0.06139088178287685},
    {.m = 0.01190668620789248, .b = 0.06451950641647841},
    {.m = 0.012654927177569303, .b = 0.06779306065881449},
    {.m = 0.013448859460098522, .b = 0.07121689362722176},
    {.m = 0.014291099046507716, .b = 0.07479641186946083},
    {.m = 0.015184388765425272, .b = 0.0785370625674281},
    {.m = 0.016131601321366984, .b = 0.08244431436068766},
    {.m = 0.01713574192230205, .b = 0.08652363555198636},
    {.m = 0.018199950420862143, .b = 0.09078046954622673},
    {.m = 0.01932750285200069, .b = 0.09522020724383477},
    {.m = 0.020521812266378503, .b = 0.09984815622454879},
    {.m = 0.02178642872874459, .b = 0.1046695064873195},
    {.m = 0.02312503833646473, .b = 0.10968929251627003},
    {.m = 0.024541461110214824, .b = 0.1149123514944735},
    {.m = 0.026039647583833148, .b = 0.12034327746133992},
    {.m = 0.02762367389794529, .b = 0.1259863712053644},
    {.m = 0.029297735210677245, .b = 0.13184558579992628},
    {.m = 0.03106613718268042, .b = 0.13792446757868718},
    {.m = 0.032933285318312744, .b = 0.14422609253644628},
    {.m = 0.03490367189744348, .b = 0.15075299807981682},
    {.m = 0.036981860222348506, .b = 0.1575071101357582},
    {.m = 0.03917246591884305, .b = 0.16448966579333452},
    {.m = 0.04148013495493408, .b = 0.171701131531119},
    {.m = 0.04390951811906596, .b = 0.1791411174712729},
    {.m = 0.04646524159310683, .b = 0.18680828789339549},
    {.m = 0.04915187336040494, .b = 0.1947002687098337},
    {.m = 0.051973885086619154, .b = 0.20281355242269955},
    {.m = 0.0549356092316825, .b = 0.21114340158069023},
    {.m = 0.058041191063073816, .b = 0.21968375161701634},
    {.m = 0.061294535384659676, .b = 0.22842711448127834},
    {.m = 0.06469924771870628, .b = 0.23736448435815066},
    {.m = 0.06825856986941137, .b = 0.24648524736933247},
    {.m = 0.0719753097265825, .b = 0.2557770970122603},
    {.m = 0.07585176538974836, .b = 0.2652259576912271},
    {.m = 0.0798896437221841, .b = 0.27481591873076194},
    {.m = 0.08408997357065484, .b = 0.28452918150535056},
    {.m = 0.08845301413225704, .b = 0.2943460227689555},
    {.m = 0.09297815896259976, .b = 0.30424477708533015},
    {.m = 0.09766383651128097, .b = 0.31420184187627775},
    {.m = 0.10250740807854575, .b = 0.32419170823376137},
    {.m = 0.10750506453010189, .b = 0.33418702113687365},
    {.m = 0.11265172316710492, .b = 0.344158672246067},
    {.m = 0.11794092655545274, .b = 0.3540759285992192},
    {.m = 0.1233647453321467, .b = 0.36390660013197695},
    {.m = 0.12891368719133167, .b = 0.37361724838555066},
    {.m = 0.1345766147227625, .b = 0.3831734385948402},
    {.m = 0.14034067467271027, .b = 0.39254003601350534},
    {.m = 0.14619124177850784, .b = 0.40168154711631404},
    {.m = 0.15211188004452048, .b = 0.410562504515333},
    {.m = 0.15808432482526147, .b = 0.41914789388764817},
    {.m = 0.16408848863497116, .b = 0.427403619125999},
    {.m = 0.17010249392151655, .b = 0.4352970010645898},
    {.m = 0.17610273538363197, .b = 0.44279730289223407},
    {.m = 0.18206397448850975, .b = 0.44987627432927646},
    {.m = 0.18795946793925378, .b = 0.4565087044613635},
    {.m = 0.1937611316179666, .b = 0.46267297211999586},
    {.m = 0.19943974043120338, .b = 0.46835158093323265},
    {.m = 0.20496516386739572, .b = 0.47353166540466296},
    {.m = 0.21030663587005627, .b = 0.47820545340699094},
    {.m = 0.21543305683476976, .b = 0.48237067044082066},
    {.m = 0.22031332395103043, .b = 0.48603087077801616},
    {.m = 0.2249166857643825, .b = 0.4891956820246957},
    {.m = 0.22921311433665004, .b = 0.4918809498823629},
    {.m = 0.23317369064758964, .b = 0.49410877405726644},
    {.m = 0.2367709880112452, .b = 0.4959074227390942},
    {.m = 0.23997947283985877, .b = 0.49731113485161266},
    {.m = 0.24277581186488284, .b = 0.4983597619859967},
    {.m = 0.2451394583116464, .b = 0.4990984015006103},
    {.m = 0.24705208480515672, .b = 0.4995765581239879},
    {.m = 0.24850116849510684, .b = 0.4998482613158535},
    {.m = 0.24946788839370093, .b = 0.4999691013031778},
    {.m = 0.24996226754236828, .b = 0.49999999999996947},
    {.m = 0.24946788839617717, .b = 0.5000308986966064},
    {.m = 0.24850116849196624, .b = 0.5001517386846328},
    {.m = 0.24705208480847674, .b = 0.5004234418752871},
    {.m = 0.24513945830827133, .b = 0.5009015985003384},
    {.m = 0.24277581186830055, .b = 0.5016402380128293},
    {.m = 0.23997947283632648, .b = 0.5026888651498196},
    {.m = 0.2367709880151878, .b = 0.5040925772590678},
    {.m = 0.233173690642122, .b = 0.5058912259456007},
    {.m = 0.22921311434459213, .b = 0.5081190501129612},
    {.m = 0.22491668575482926, .b = 0.510804317981563},
    {.m = 0.22031332396101, .b = 0.5139691292148137},
    {.m = 0.21543305682469693, .b = 0.5176293295670485},
    {.m = 0.21030663588007137, .b = 0.5217945465845568},
    {.m = 0.2049651638577039, .b = 0.5264683346041283},
    {.m = 0.19943974043966328, .b = 0.5316484190585414},
    {.m = 0.19376113161122, .b = 0.5373270278869847},
    {.m = 0.1879594679461558, .b = 0.5434912955311154},
    {.m = 0.18206397448047085, .b = 0.550123725680011},
    {.m = 0.17610273539197507, .b = 0.5572026970975997},
    {.m = 0.17010249391309173, .b = 0.5647029989462039},
    {.m = 0.16408848864341863, .b = 0.5725963808626499},
    {.m = 0.15808432481680867, .b = 0.5808521061242385},
    {.m = 0.15211188005297238, .b = 0.5894374954722532},
    {.m = 0.14619124177006704, .b = 0.5983184528966112},
    {.m = 0.14034067468110933, .b = 0.6074599639731076},
    {.m = 0.13457661471451132, .b = 0.6168265614188294},
    {.m = 0.1289136871990344, .b = 0.6263827516011967},
    {.m = 0.12336474532649966, .b = 0.6360933998781325},
    {.m = 0.11794092655604871, .b = 0.6459240713995749},
    {.m = 0.1126517231711226, .b = 0.6558413277463113},
    {.m = 0.10750506452411202, .b = 0.6658129788748943},
    {.m = 0.10250740808527503, .b = 0.6758082917525683},
    {.m = 0.09766383650557309, .b = 0.6857981581357036},
    {.m = 0.09297815896348283, .b = 0.6957552229126454},
    {.m = 0.08845301413629336, .b = 0.7056539772221223},
    {.m = 0.08408997356529646, .b = 0.7154708185068653},
    {.m = 0.07988964372774454, .b = 0.7251840812562041},
    {.m = 0.07585176538470151, .b = 0.7347740423209314},
    {.m = 0.07197530972936939, .b = 0.7442229029808034},
    {.m = 0.06825856987095413, .b = 0.7535147526268415},
    {.m = 0.06469924771394453, .b = 0.7626355156541786},
    {.m = 0.06129453539032248, .b = 0.7715728855036865},
    {.m = 0.05804119105702732, .b = 0.7803162483994173},
    {.m = 0.054935609237945826, .b = 0.7888565984018914},
    {.m = 0.05197388508029732, .b = 0.7971864475952778},
    {.m = 0.04915187336674087, .b = 0.8052997312717526},
    {.m = 0.0464652415867679, .b = 0.8131917121254232},
    {.m = 0.04390951812540678, .b = 0.8208588825095066},
    {.m = 0.041480134948592706, .b = 0.8282988684884997},
    {.m = 0.0391724659251782, .b = 0.83551033418667},
    {.m = 0.036981860216034335, .b = 0.842492889884566},
    {.m = 0.034903671903681044, .b = 0.8492470018997142},
    {.m = 0.032933285312363836, .b = 0.8557739074834525},
    {.m = 0.031066137187551135, .b = 0.8620755324046954},
    {.m = 0.029297735210425557, .b = 0.8681544142010645},
    {.m = 0.027623673893316436, .b = 0.8740136288109465},
    {.m = 0.026039647589874093, .b = 0.8796567225169598},
    {.m = 0.024541461103785522, .b = 0.8850876485290309},
    {.m = 0.02312503834303392, .b = 0.8903107074593024},
    {.m = 0.02178642872200598, .b = 0.8953304935381572},
    {.m = 0.020521812273269546, .b = 0.9001518437489648},
    {.m = 0.019327502845092326, .b = 0.9047797927831516},
    {.m = 0.01819995042765221, .b = 0.909219530426822},
    {.m = 0.01713574191566103, .b = 0.9134763644747868},
    {.m = 0.01613160132795244, .b = 0.9175556856123529},
    {.m = 0.015184388758825662, .b = 0.9214629374600009},
    {.m = 0.014291099053110656, .b = 0.9252035881026824},
    {.m = 0.013448859453609074, .b = 0.9287831064005642},
    {.m = 0.012654927183531228, .b = 0.9322069393152749},
    {.m = 0.011906686204133266, .b = 0.935480493600141},
    {.m = 0.011201644035764957, .b = 0.9386091182222753},
    {.m = 0.010537428017650896, .b = 0.9415980903037886},
    {.m = 0.009911781525252295, .b = 0.9444526024253572},
    {.m = 0.009322560099327859, .b = 0.9471777515202577},
    {.m = 0.008767727244171297, .b = 0.9497785305288041},
    {.m = 0.008245350521356443, .b = 0.9522598199621747},
    {.m = 0.007753597245695687, .b = 0.9546263826012921},
    {.m = 0.007290730518867861, .b = 0.9568828578945777},
    {.m = 0.006855105106998494, .b = 0.9590337583656827},
    {.m = 0.006445163362320372, .b = 0.9610834670890733},
    {.m = 0.006059431427074102, .b = 0.9630362350112576},
    {.m = 0.005696515186443207, .b = 0.9648961807444909},
    {.m = 0.005355096697437389, .b = 0.9666672891562086},
    {.m = 0.0050339303899349375, .b = 0.9683534122705965},
    {.m = 0.00473183958393264, .b = 0.9699582696774837},
    {.m = 0.00444771312468184, .b = 0.9714854493959567},
    {.m = 0.004180501938057191, .b = 0.9729384102232282},
    {.m = 0.0039292160464743375, .b = 0.9743204826269339},
    {.m = 0.0036929213222833823, .b = 0.9756348720302461},
    {.m = 0.0034707367341919593, .b = 0.9768846603382604},
    {.m = 0.003261831441756513, .b = 0.978072809188987},
    {.m = 0.0030654221219190703, .b = 0.9792021627780523},
    {.m = 0.0028807705094990865, .b = 0.9802754502752434},
    {.m = 0.002707180790196162, .b = 0.9812952898761481},
    {.m = 0.0025439974722250014, .b = 0.9822641908266019},
    {.m = 0.002390602981497736, .b = 0.9831845577709655},
    {.m = 0.0022464157077592972, .b = 0.9840586931180048},
    {.m = 0.0021108879395956848, .b = 0.9848888006980069},
    {.m = 0.0019835039197424464, .b = 0.9856769893208488},
    {.m = 0.00186377818165262, .b = 0.9864252751839102},
    {.m = 0.0017512536511397059, .b = 0.987135586282773},
    {.m = 0.001645500236165276, .b = 0.987809764303235},
    {.m = 0.0015461130789180544, .b = 0.988449569128014},
    {.m = 0.0014527113201534547, .b = 0.9890566805599839},
    {.m = 0.0013649365095229626, .b = 0.9896327027547465},
    {.m = 0.0012824515232150446, .b = 0.9901791657890364},
    {.m = 0.0012049391198516446, .b = 0.9906975299865292},
    {.m = 0.001132100996864338, .b = 0.9911891873166935},
    {.m = 0.001063656478368813, .b = 0.9916554655989442},
    {.m = 0.0009993416970033309, .b = 0.9920976297208319},
    {.m = 0.0009389084009399085, .b = 0.9925168857122719},
    {.m = 0.0008821232488323005, .b = 0.9929143817770252},
    {.m = 0.0008287667240445273, .b = 0.9932912122333388},
    {.m = 0.0007786325312970632, .b = 0.9936484183566645},
    {.m = 0.0007315266070868631, .b = 0.9939869921869253},
    {.m = 0.0006872666078265866, .b = 0.9943078771815623},
    {.m = 0.0006456810052970496, .b = 0.9946119719000596},
    {.m = 0.0006066086609664012, .b = 0.9949001304394981},
    {.m = 0.0005698979814123817, .b = 0.9951731661186811},
    {.m = 0.000535406629506241, .b = 0.9954318512579772},
    {.m = 0.0005030005099921908, .b = 0.9956769225368022},
    {.m = 0.0004725544258654679, .b = 0.9959090739282684},
    {.m = 0.00044394792968383, .b = 0.9961289863676648},
    {.m = 0.0004170776042684565, .b = 0.9963372313896339},
    {.m = 0.00039181077803895903, .b = 0.9965346284695519},
    {.m = 0.00036815315578131447, .b = 0.9967209322448308},
    {.m = 0, .b = 1}};

constexpr LinearSegment kSigmoidDLut255[] = {
    {.m = 0, .b = 0},
    {.m = 0.007144342546169123, .b = 0.05715474036935298},
    {.m = -0.001453804959482042, .b = -0.011093055456753136},
    {.m = 0.0008795638755290779, .b = 0.007282224118959431},
    {.m = 0.0002860010045938185, .b = 0.0026450141897777168},
    {.m = 0.0004785478843088711, .b = 0.004137252507569375},
    {.m = 0.0004627537912774383, .b = 0.004015835417390235},
    {.m = 0.0005049874745252352, .b = 0.0043378672521546865},
    {.m = 0.0005341721607095111, .b = 0.004558576441423273},
    {.m = 0.0005694220575920717, .b = 0.004822950668042478},
    {.m = 0.0006058273781305145, .b = 0.0050937152395471455},
    {.m = 0.0006448584341417433, .b = 0.005381569277629958},
    {.m = 0.0006863187482527844, .b = 0.005684747824566946},
    {.m = 0.0007304565646933762, .b = 0.0060047469937612365},
    {.m = 0.0007774193307017018, .b = 0.006342291874446077},
    {.m = 0.0008273923031959021, .b = 0.006698349303467254},
    {.m = 0.0008805661449715896, .b = 0.007073889561008047},
    {.m = 0.0009371441678655106, .b = 0.007469935721265494},
    {.m = 0.0009973430228953726, .b = 0.007887565278035162},
    {.m = 0.001061392040690265, .b = 0.008327902275375047},
    {.m = 0.0011295356319068056, .b = 0.00879213049053773},
    {.m = 0.0012020328051218117, .b = 0.009281486409739022},
    {.m = 0.0012791589756501603, .b = 0.009797267675147351},
    {.m = 0.0013612065596951065, .b = 0.01034083291944512},
    {.m = 0.0014484857485188747, .b = 0.0109136025961011},
    {.m = 0.0015413263505636293, .b = 0.011517066509392004},
    {.m = 0.0016400776463156193, .b = 0.01215277797579544},
    {.m = 0.0017451111573504492, .b = 0.012822366608642482},
    {.m = 0.0018568200352527507, .b = 0.013527528900400758},
    {.m = 0.001975622297200646, .b = 0.014270043037575104},
    {.m = 0.002101960194055584, .b = 0.015051758774365032},
    {.m = 0.002236303482108848, .b = 0.015874611413691276},
    {.m = 0.0023791492615500356, .b = 0.016740613951553476},
    {.m = 0.002531024722700781, .b = 0.017651866718457948},
    {.m = 0.0026924880209875934, .b = 0.018610555052035897},
    {.m = 0.0028641301047846596, .b = 0.019618952294343663},
    {.m = 0.00304657665218145, .b = 0.020679422851087505},
    {.m = 0.0032404893834398346, .b = 0.021794421055823215},
    {.m = 0.0034465683274109496, .b = 0.022966495049658933},
    {.m = 0.0036655533593035403, .b = 0.024198285854054757},
    {.m = 0.003898226304144041, .b = 0.02549252910973004},
    {.m = 0.004145412708910834, .b = 0.026852054335947402},
    {.m = 0.004407984117346428, .b = 0.028279786369315944},
    {.m = 0.004686859540443317, .b = 0.029778741768461722},
    {.m = 0.004983008192006991, .b = 0.03135203147989374},
    {.m = 0.0052974506760482265, .b = 0.03300285452111023},
    {.m = 0.005631261653008507, .b = 0.03473449896409168},
    {.m = 0.005985571341209001, .b = 0.036550336116119214},
    {.m = 0.006361567502145213, .b = 0.03845381668085879},
    {.m = 0.006760497299499291, .b = 0.04044846566762918},
    {.m = 0.007183668823460082, .b = 0.04253787506718558},
    {.m = 0.00763245251096431, .b = 0.04472569554376869},
    {.m = 0.008108282871051975, .b = 0.04701562915169058},
    {.m = 0.008612658549305735, .b = 0.04941141362339594},
    {.m = 0.009147144619711278, .b = 0.051916817078421926},
    {.m = 0.009713370851209824, .b = 0.0545356133991027},
    {.m = 0.010313034111775088, .b = 0.057271577025431716},
    {.m = 0.01094789524997769, .b = 0.06012845214734343},
    {.m = 0.011619780246412303, .b = 0.06310994181902202},
    {.m = 0.012330576546493721, .b = 0.06621967563187822},
    {.m = 0.013082231554503138, .b = 0.06946118785391883},
    {.m = 0.013876748613546874, .b = 0.07283788535485472},
    {.m = 0.014716182237847347, .b = 0.07635301365661294},
    {.m = 0.015602632850581721, .b = 0.08000962243414224},
    {.m = 0.016538238924554638, .b = 0.0838105221096572},
    {.m = 0.017525168881156628, .b = 0.08775824193606517},
    {.m = 0.0185656103818001, .b = 0.09185498034484885},
    {.m = 0.019661757980707184, .b = 0.09610255229061379},
    {.m = 0.020815798952623477, .b = 0.10050233349604465},
    {.m = 0.022029896128386184, .b = 0.10505519790515482},
    {.m = 0.023306168682024897, .b = 0.10976145294669756},
    {.m = 0.024646669933492293, .b = 0.11462076998326688},
    {.m = 0.02605336147303533, .b = 0.11963210859288895},
    {.m = 0.02752808511466509, .b = 0.12479364133859311},
    {.m = 0.0290725294944828, .b = 0.1301026688942165},
    {.m = 0.030688194430519955, .b = 0.1355555380533419},
    {.m = 0.03237634990061555, .b = 0.14114755304803356},
    {.m = 0.034137990665091156, .b = 0.14687288553257927},
    {.m = 0.03597378767552328, .b = 0.15272448850333167},
    {.m = 0.037884031415912234, .b = 0.15869400019204713},
    {.m = 0.03986857525736531, .b = 0.1647716657064972},
    {.m = 0.041926767374983465, .b = 0.17094624205935166},
    {.m = 0.044057385018400175, .b = 0.17720493138688823},
    {.m = 0.046258556267078754, .b = 0.18353329872683916},
    {.m = 0.04852768458429835, .b = 0.18991522211901926},
    {.m = 0.05086136254783169, .b = 0.19633283651873595},
    {.m = 0.053255287607445245, .b = 0.20276651011644736},
    {.m = 0.055704170654161, .b = 0.20919482811407625},
    {.m = 0.05820164608716305, .b = 0.21559460891114396},
    {.m = 0.06074017933593945, .b = 0.22194094203308498},
    {.m = 0.0633109766944826, .b = 0.22820726059453392},
    {.m = 0.06590389797081109, .b = 0.23436544862581407},
    {.m = 0.0685073740264226, .b = 0.24038598700441569},
    {.m = 0.07110833329059707, .b = 0.24623814534880825},
    {.m = 0.0736921377722155, .b = 0.2518902176523486},
    {.m = 0.07624253481668952, .b = 0.2573098113718559},
    {.m = 0.078741625245065, .b = 0.2624641853803803},
    {.m = 0.08116985438280855, .b = 0.2673206436558674},
    {.m = 0.08350602816077157, .b = 0.2718469803506708},
    {.m = 0.0857273597111825, .b = 0.27601197700769126},
    {.m = 0.0878095502909495, .b = 0.2797859474335189},
    {.m = 0.08972690846971831, .b = 0.28314132424636435},
    {.m = 0.09145251223744566, .b = 0.28605328060440427},
    {.m = 0.09295841595838183, .b = 0.28850037415092555},
    {.m = 0.09421590695084214, .b = 0.29046520382664476},
    {.m = 0.09519581046200809, .b = 0.2919350590933937},
    {.m = 0.09586884720188582, .b = 0.2929025494069679},
    {.m = 0.09620603810838091, .b = 0.29336618690339866},
    {.m = 0.09617915839602853, .b = 0.29333090728093614},
    {.m = 0.09576123149799143, .b = 0.29280849865838976},
    {.m = 0.09492706064187706, .b = 0.29181792076675395},
    {.m = 0.0936537855278381, .b = 0.29038548626346017},
    {.m = 0.09192145575123023, .b = 0.2885448858758143},
    {.m = 0.08971360621234181, .b = 0.28633703633692587},
    {.m = 0.08701782015595727, .b = 0.28380973690906536},
    {.m = 0.08382626360600742, .b = 0.28101712492785924},
    {.m = 0.08013617107290649, .b = 0.27801892474471473},
    {.m = 0.07595027534724874, .b = 0.2748795029504714},
    {.m = 0.07127711725243602, .b = 0.2716667067602877},
    {.m = 0.06613140718590316, .b = 0.2684506379687046},
    {.m = 0.06053367531828968, .b = 0.26530191379317203},
    {.m = 0.05451210062309331, .b = 0.26229112644557384},
    {.m = 0.04809541248475524, .b = 0.259483825385051},
    {.m = 0.0413388681898228, .b = 0.25695012127445127},
    {.m = 0.03422530376383426, .b = 0.2547271323913299},
    {.m = 0.027033264550972103, .b = 0.25292912258811434},
    {.m = 0.018958814625563036, .b = 0.2514151632271001},
    {.m = 0.013257955287116818, .b = 0.2507025558097944},
    {.m = 7.565059689795817e-13, .b = 0.24987393360439686},
    {.m = -0.01325795529060736, .b = 0.2507025558101071},
    {.m = -0.018958814620454234, .b = 0.25141516322633795},
    {.m = -0.027033264559108705, .b = 0.2529291225898357},
    {.m = -0.034225303751643565, .b = 0.2547271323879694},
    {.m = -0.04133886820602806, .b = 0.2569501212799645},
    {.m = -0.04809541246560167, .b = 0.25948382537730463},
    {.m = -0.054512100643994366, .b = 0.26229112645535146},
    {.m = -0.06053367529599418, .b = 0.2653019137813514},
    {.m = -0.0661314072103627, .b = 0.26845063798318364},
    {.m = -0.07127711722449215, .b = 0.27166670674201454},
    {.m = -0.07595027537960064, .b = 0.2748795029736516},
    {.m = -0.08013617103625092, .b = 0.2780189247161393},
    {.m = -0.08382626364563572, .b = 0.2810171249612645},
    {.m = -0.08701782011539194, .b = 0.28380973687230115},
    {.m = -0.08971360625191593, .b = 0.2863370363752924},
    {.m = -0.09192145571378818, .b = 0.28854488583716464},
    {.m = -0.09365378556334703, .b = 0.29038548630232097},
    {.m = -0.09492706060725142, .b = 0.2918179207267134},
    {.m = -0.09576123153312555, .b = 0.2928084987011889},
    {.m = -0.09617915835879298, .b = 0.2933309072332732},
    {.m = -0.0962060381490013, .b = 0.2933661869579216},
    {.m = -0.09586884715658162, .b = 0.2929025493433446},
    {.m = -0.09519581051212445, .b = 0.2919350591669374},
    {.m = -0.09421590689799642, .b = 0.29046520374574536},
    {.m = -0.09295841600997745, .b = 0.28850037423321573},
    {.m = -0.09145251219282802, .b = 0.28605328053034784},
    {.m = -0.08972690850141252, .b = 0.2831413243010842},
    {.m = -0.08780955027651771, .b = 0.2797859474075183},
    {.m = -0.08572735970706291, .b = 0.2760119770003815},
    {.m = -0.08350602818143726, .b = 0.2718469803898334},
    {.m = -0.08116985435036095, .b = 0.26732064359212304},
    {.m = -0.07874162528283479, .b = 0.26246418545707073},
    {.m = -0.07624253478076537, .b = 0.2573098112965525},
    {.m = -0.07369213779987827, .b = 0.25189021771216746},
    {.m = -0.07110833327447552, .b = 0.24623814531284893},
    {.m = -0.06850737403206653, .b = 0.2403859870174287},
    {.m = -0.06590389797101404, .b = 0.2343654486262448},
    {.m = -0.0633109766938027, .b = 0.2282072605928679},
    {.m = -0.060740179334478395, .b = 0.2219409420295149},
    {.m = -0.05820164608882461, .b = 0.21559460891538043},
    {.m = -0.05570417065751254, .b = 0.20919482812264326},
    {.m = -0.05325528759379006, .b = 0.20276651008037175},
    {.m = -0.050861362574269764, .b = 0.19633283659041095},
    {.m = -0.048527684546536554, .b = 0.18991522201414462},
    {.m = -0.04625855631160325, .b = 0.1835332988533947},
    {.m = -0.044057384973249625, .b = 0.17720493125562803},
    {.m = -0.041926767414224186, .b = 0.1709462421759908},
    {.m = -0.039868575230138203, .b = 0.16477166562373285},
    {.m = -0.03788403142645813, .b = 0.15869400022496263},
    {.m = -0.035973787683699854, .b = 0.15272448852884302},
    {.m = -0.03413799063952161, .b = 0.14687288545052485},
    {.m = -0.03237634993905936, .b = 0.14114755317402256},
    {.m = -0.03068819438600534, .b = 0.13555553790453112},
    {.m = -0.029072529537032377, .b = 0.13010266903924736},
    {.m = -0.02752808508230209, .b = 0.124793641226112},
    {.m = -0.026053361487973103, .b = 0.11963210864596055},
    {.m = -0.02464666994089071, .b = 0.11462077000947951},
    {.m = -0.023306168650883197, .b = 0.10976145283320228},
    {.m = -0.022029896180980058, .b = 0.10505519810043447},
    {.m = -0.020815798883480674, .b = 0.10050233323481177},
    {.m = -0.019661758060544432, .b = 0.09610255259736736},
    {.m = -0.01856561029698728, .b = 0.09185498001358337},
    {.m = -0.017525168965474625, .b = 0.08775824227075231},
    {.m = -0.01653823884608796, .b = 0.08381052179320564},
    {.m = -0.015602632918525428, .b = 0.08000962271248285},
    {.m = -0.014716182183020926, .b = 0.0763530134285268},
    {.m = -0.013876748656039495, .b = 0.07283788553429205},
    {.m = -0.013082231520180315, .b = 0.06946118770689053},
    {.m = -0.012330576578399893, .b = 0.06621967577046246},
    {.m = -0.011619780212388242, .b = 0.06310994166916149},
    {.m = -0.01094789528734283, .b = 0.06012845231427247},
    {.m = -0.010313034072992722, .b = 0.057271576849696984},
    {.m = -0.009713370888812356, .b = 0.05453561357187407},
    {.m = -0.009147144583576433, .b = 0.051916816910157926},
    {.m = -0.008612658587108551, .b = 0.049411413801714724},
    {.m = -0.008108282826746194, .b = 0.04701562893999353},
    {.m = -0.007632452564916251, .b = 0.044725695804936925},
    {.m = -0.007183668761211015, .b = 0.0425378747618739},
    {.m = -0.006760497363677773, .b = 0.040448465986553515},
    {.m = -0.006361567445381411, .b = 0.03845381639507171},
    {.m = -0.005985571381873042, .b = 0.0365503363235606},
    {.m = -0.005631261632989923, .b = 0.03473449886053461},
    {.m = -0.005297450676555057, .b = 0.03300285452402874},
    {.m = -0.004983008205396183, .b = 0.03135203155044465},
    {.m = -0.004686859520234829, .b = 0.02977874166052496},
    {.m = -0.004407984138588589, .b = 0.028279786484176415},
    {.m = -0.004145412690272257, .b = 0.026852054233956365},
    {.m = -0.003898226317758491, .b = 0.02549252918513065},
    {.m = -0.003665553353156062, .b = 0.02419828581952964},
    {.m = -0.003446568323464419, .b = 0.022966495027514147},
    {.m = -0.0032404893990808994, .b = 0.021794421145082878},
    {.m = -0.003046576626092895, .b = 0.020679422700401854},
    {.m = -0.002864130136005505, .b = 0.0196189524767689},
    {.m = -0.0026924879937325896, .b = 0.018610554890915523},
    {.m = -0.0025310247350306195, .b = 0.017651866792372576},
    {.m = -0.002379149274055768, .b = 0.016740614026523465},
    {.m = -0.0022363034387918104, .b = 0.015874611150235723},
    {.m = -0.002101960268309805, .b = 0.015051759231033439},
    {.m = -0.0019756221980165543, .b = 0.014270042421093952},
    {.m = -0.0018568201487625773, .b = 0.013527529613256595},
    {.m = -0.0017451110418335927, .b = 0.01282236587576738},
    {.m = -0.0016400777529431664, .b = 0.01215277865909091},
    {.m = -0.0015413262601542445, .b = 0.011517065924262227},
    {.m = -0.001448485819383498, .b = 0.010913603059252375},
    {.m = -0.0013612065087588582, .b = 0.010340832583278177},
    {.m = -0.001279159007645761, .b = 0.009797267888403906},
    {.m = -0.0012020327907188225, .b = 0.009281486312705006},
    {.m = -0.0011295356304125634, .b = 0.008792130480637757},
    {.m = -0.001061392055393233, .b = 0.008327902375818569},
    {.m = -0.0009973429996724091, .b = 0.007887565117737904},
    {.m = -0.0009371441895689569, .b = 0.007469935872645204},
    {.m = -0.0008805661567890602, .b = 0.007073889643185927},
    {.m = -0.0008273921294528752, .b = 0.006698348075124121},
    {.m = -0.0007774201986936839, .b = 0.006342298068464884},
    {.m = -0.0007304528445167824, .b = 0.006004720210318403},
    {.m = -0.0006863338498216184, .b = 0.0056848574987784645},
    {.m = -0.0006447989073916534, .b = 0.005381133232259345},
    {.m = -0.0006060574762732657, .b = 0.005095415177761237},
    {.m = -0.0005685446860955838, .b = 0.0048164138008147265},
    {.m = -0.0005374867962304065, .b = 0.004583479626825897},
    {.m = -0.000492538015225457, .b = 0.004243554470475967},
    {.m = -0.000509355846013586, .b = 0.00437179043023545},
    {.m = -0.0003044047810968854, .b = 0.0027962291186883143},
    {.m = -0.000936226263229591, .b = 0.007692845605216783},
    {.m = 0.001547520702271741, .b = -0.011711427562762373},
    {.m = -0.00760476748204139, .b = 0.060362841888703535},
    {.m = 0, .b = 0}};

// Hyperbolic Tan:

constexpr LinearSegment kTanhLut255[] = {
    {.m = 0, .b = -1},
    {.m = 5.038933846179816e-06, .b = -0.9999596885292306},
    {.m = -6.79211138887581e-07, .b = -1.0000050763050496},
    {.m = 9.422435933714723e-07, .b = -0.999992307349033},
    {.m = 6.09024803921443e-07, .b = -0.9999949106208256},
    {.m = 8.130038118281391e-07, .b = -0.9999933297835143},
    {.m = 8.883375617330103e-07, .b = -0.9999927506553119},
    {.m = 1.015427422146331e-06, .b = -0.9999917815951263},
    {.m = 1.148280075469188e-06, .b = -0.9999907768969355},
    {.m = 1.3017910571733182e-06, .b = -0.9999896255645727},
    {.m = 1.474965879211254e-06, .b = -0.9999883375768338},
    {.m = 1.6713907111665094e-06, .b = -0.9999868889436981},
    {.m = 1.8939273349616315e-06, .b = -0.9999852616446366},
    {.m = 2.1461007371215146e-06, .b = -0.999983433387471},
    {.m = 2.4318503495379673e-06, .b = -0.9999813795621317},
    {.m = 2.755647019014873e-06, .b = -0.9999790725108617},
    {.m = 3.122556586632186e-06, .b = -0.9999764812120404},
    {.m = 3.5383194312288424e-06, .b = -0.9999735708721282},
    {.m = 4.009440246477425e-06, .b = -0.9999703024714724},
    {.m = 4.543289799485706e-06, .b = -0.9999666322557955},
    {.m = 5.148220255435376e-06, .b = -0.9999625111670644},
    {.m = 5.8336958232985126e-06, .b = -0.9999578842069813},
    {.m = 6.6104408293909955e-06, .b = -0.999952689724753},
    {.m = 7.49060751203956e-06, .b = -0.9999468586204805},
    {.m = 8.487966082881826e-06, .b = -0.9999403134548593},
    {.m = 9.618120213161774e-06, .b = -0.9999329674530125},
    {.m = 1.0898751067855983e-05, .b = -0.9999247233918854},
    {.m = 1.2349893966145942e-05, .b = -0.9999154723559088},
    {.m = 1.39942517520808e-05, .b = -0.9999050923473851},
    {.m = 1.5857549970021978e-05, .b = -0.999893446733523},
    {.m = 1.7968939269863426e-05, .b = -0.9998803825122302},
    {.m = 2.0361451415595866e-05, .b = -0.9998657283753376},
    {.m = 2.3072515935140814e-05, .b = -0.9998492925466879},
    {.m = 2.6144545634210203e-05, .b = -0.9998308603684934},
    {.m = 2.9625599944793635e-05, .b = -0.9998101916085244},
    {.m = 3.357013662252939e-05, .b = -0.9997870174555427},
    {.m = 3.803986347961086e-05, .b = -0.9997610371681859},
    {.m = 4.310470343327211e-05, .b = -0.9997319143384523},
    {.m = 4.884388803283457e-05, .b = -0.9996992727260423},
    {.m = 5.534719642596997e-05, .b = -0.9996626916163309},
    {.m = 6.271635921528684e-05, .b = -0.9996217006483153},
    {.m = 7.106664908640425e-05, .b = -0.9995757740540242},
    {.m = 8.052868296992699e-05, .b = -0.9995243242447825},
    {.m = 9.125046395475067e-05, .b = -0.9994666946719891},
    {.m = 0.00010339969473349697, .b = -0.999402151883477},
    {.m = 0.0001171663986152538, .b = -0.9993298766880978},
    {.m = 0.00013276588905597464, .b = -0.9992489543314366},
    {.m = 0.00015044213376391724, .b = -0.9991583635773084},
    {.m = 0.00017047156594252044, .b = -0.9990569645769042},
    {.m = 0.0001931674017363605, .b = -0.998943485397935},
    {.m = 0.0002188845311419385, .b = -0.9988165070714949},
    {.m = 0.0002480250581307075, .b = -0.9986744470024247},
    {.m = 0.0002810445760577096, .b = -0.998515540572401},
    {.m = 0.0003184592754550408, .b = -0.9983378207502637},
    {.m = 0.0003608539941470923, .b = -0.9981390955063947},
    {.m = 0.0004088913340858369, .b = -0.997916922809178},
    {.m = 0.0004633219853946713, .b = -0.9976685829625814},
    {.m = 0.0005249964164697474, .b = -0.9973910480227436},
    {.m = 0.0005948781096822842, .b = -0.997080948009113},
    {.m = 0.0006740585452202907, .b = -0.9967345336036342},
    {.m = 0.0007637741620349914, .b = -0.9963476350061208},
    {.m = 0.0008654255537567934, .b = -0.9959156165913031},
    {.m = 0.0009805991908784506, .b = -0.9954333269858562},
    {.m = 0.001111091996845559, .b = -0.9948950441612419},
    {.m = 0.0012589391474531197, .b = -0.9942944151118986},
    {.m = 0.001426445508677432, .b = -0.9936243896670014},
    {.m = 0.001616221179643773, .b = -0.9928771479625714},
    {.m = 0.0018312216644762458, .b = -0.9920440210838456},
    {.m = 0.0020747932600091445, .b = -0.9911154043758764},
    {.m = 0.0023507243163045644, .b = -0.9900806629147686},
    {.m = 0.002663303103810577, .b = -0.9889280286358402},
    {.m = 0.0030173831050053224, .b = -0.9876444886315092},
    {.m = 0.003418456640227774, .b = -0.9862156641622792},
    {.m = 0.0038727378358629494, .b = -0.9846256799775561},
    {.m = 0.0043872560495383794, .b = -0.9828570236180468},
    {.m = 0.004969960978346677, .b = -0.9808903944833188},
    {.m = 0.00562984079397566, .b = -0.9787045425940478},
    {.m = 0.006377054767430224, .b = -0.9762760971803205},
    {.m = 0.0072230819664369506, .b = -0.9735793854834865},
    {.m = 0.008180887722497587, .b = -0.9705862424957971},
    {.m = 0.009265109668906035, .b = -0.9672658127849212},
    {.m = 0.010492265235399145, .b = -0.9635843460854419},
    {.m = 0.011880982538853502, .b = -0.9595049890065447},
    {.m = 0.01345225661828664, .b = -0.9549875760281744},
    {.m = 0.015229732905522653, .b = -0.9499884239703231},
    {.m = 0.01724001967609823, .b = -0.9444601353512403},
    {.m = 0.01951303095522583, .b = -0.9383514175385849},
    {.m = 0.0220823609195282, .b = -0.9316069263822911},
    {.m = 0.024985690184989195, .b = -0.9241671451395473},
    {.m = 0.028265223439964515, .b = -0.915968312002109},
    {.m = 0.03196815658952268, .b = -0.906942412450061},
    {.m = 0.03614716982527, .b = -0.8970172560151611},
    {.m = 0.04086094070781421, .b = -0.8861166608492776},
    {.m = 0.046174668306596445, .b = -0.8741607737520176},
    {.m = 0.05216059552627428, .b = -0.8610665579589724},
    {.m = 0.058898511778529894, .b = -0.8467484859229292},
    {.m = 0.06647621193943287, .b = -0.8311194793410668},
    {.m = 0.07498987986388883, .b = -0.8140921434921549},
    {.m = 0.08454435542249072, .b = -0.7955803470973637},
    {.m = 0.09525323293187782, .b = -0.7755012017672629},
    {.m = 0.10723872589842998, .b = -0.7537774957653871},
    {.m = 0.12063121825701373, .b = -0.7303406341378655},
    {.m = 0.13556840605216713, .b = -0.7051341297335442},
    {.m = 0.1521939164008863, .b = -0.6781176754168755},
    {.m = 0.17065527367984323, .b = -0.6492718046685053},
    {.m = 0.19110106791190518, .b = -0.6186031133204124},
    {.m = 0.21367716980897988, .b = -0.5861499668433675},
    {.m = 0.238521834360494, .b = -0.5519885530850356},
    {.m = 0.26575954484341047, .b = -0.5162390580762077},
    {.m = 0.2954934773925242, .b = -0.4790716423898156},
    {.m = 0.3277965194612271, .b = -0.44071177993323085},
    {.m = 0.36270086069910157, .b = -0.4014443960406221},
    {.m = 0.4001862985040585, .b = -0.36161611837285534},
    {.m = 0.4401675672155978, .b = -0.32163484966131606},
    {.m = 0.4824812097618896, .b = -0.2819658097741675},
    {.m = 0.5268727566777756, .b = -0.24312320622276729},
    {.m = 0.5729852429551183, .b = -0.2056568111224263},
    {.m = 0.6203503480424875, .b = -0.17013298230689944},
    {.m = 0.6683836484970112, .b = -0.1371100882444144},
    {.m = 0.7163855563025887, .b = -0.10710889586592842},
    {.m = 0.7635494771904625, .b = -0.08057919036649941},
    {.m = 0.8089782733475968, .b = -0.05786479228793229},
    {.m = 0.8517100970008924, .b = -0.039169619439615444},
    {.m = 0.8907517796150124, .b = -0.024528988459320444},
    {.m = 0.9251245978892042, .b = -0.013787482748635504},
    {.m = 0.9538974931161661, .b = -0.006594258941895026},
    {.m = 0.976288625203984, .b = -0.00239592167542918},
    {.m = 0.9915166554254227, .b = -0.0004924178977493421},
    {.m = 0.9993953417894121, .b = 0.0},
    {.m = 0.9915166554254227, .b = 0.0004924178977493421},
    {.m = 0.976288625203984, .b = 0.00239592167542918},
    {.m = 0.9538974931161657, .b = 0.006594258941895109},
    {.m = 0.9251245978892055, .b = 0.013787482748635144},
    {.m = 0.8907517796150115, .b = 0.024528988459320777},
    {.m = 0.8517100970008924, .b = 0.039169619439615444},
    {.m = 0.8089782733475968, .b = 0.05786479228793229},
    {.m = 0.7635494771904625, .b = 0.08057919036649941},
    {.m = 0.7163855563025887, .b = 0.10710889586592842},
    {.m = 0.6683836484970112, .b = 0.1371100882444144},
    {.m = 0.6203503480424875, .b = 0.17013298230689944},
    {.m = 0.5729852429551183, .b = 0.2056568111224263},
    {.m = 0.5268727566777756, .b = 0.24312320622276729},
    {.m = 0.4824812097618896, .b = 0.2819658097741675},
    {.m = 0.4401675672155978, .b = 0.32163484966131606},
    {.m = 0.4001862985040585, .b = 0.36161611837285534},
    {.m = 0.36270086069910157, .b = 0.4014443960406221},
    {.m = 0.3277965194612271, .b = 0.44071177993323085},
    {.m = 0.2954934773925242, .b = 0.4790716423898156},
    {.m = 0.26575954484341047, .b = 0.5162390580762077},
    {.m = 0.238521834360494, .b = 0.5519885530850356},
    {.m = 0.21367716980897988, .b = 0.5861499668433675},
    {.m = 0.19110106791190518, .b = 0.6186031133204124},
    {.m = 0.17065527367984323, .b = 0.6492718046685053},
    {.m = 0.1521939164008863, .b = 0.6781176754168755},
    {.m = 0.13556840605216713, .b = 0.7051341297335442},
    {.m = 0.12063121825701373, .b = 0.7303406341378655},
    {.m = 0.10723872589842998, .b = 0.7537774957653871},
    {.m = 0.09525323293187782, .b = 0.7755012017672629},
    {.m = 0.08454435542249072, .b = 0.7955803470973637},
    {.m = 0.07498987986388883, .b = 0.8140921434921549},
    {.m = 0.06647621193943287, .b = 0.8311194793410668},
    {.m = 0.058898511778529894, .b = 0.8467484859229292},
    {.m = 0.05216059552627428, .b = 0.8610665579589724},
    {.m = 0.046174668306596445, .b = 0.8741607737520176},
    {.m = 0.04086094070781421, .b = 0.8861166608492776},
    {.m = 0.03614716982527, .b = 0.8970172560151611},
    {.m = 0.03196815658952268, .b = 0.906942412450061},
    {.m = 0.028265223439964515, .b = 0.915968312002109},
    {.m = 0.024985690184989195, .b = 0.9241671451395473},
    {.m = 0.0220823609195282, .b = 0.9316069263822911},
    {.m = 0.01951303095522583, .b = 0.9383514175385849},
    {.m = 0.01724001967609823, .b = 0.9444601353512403},
    {.m = 0.015229732905522653, .b = 0.9499884239703231},
    {.m = 0.01345225661828664, .b = 0.9549875760281744},
    {.m = 0.011880982538853502, .b = 0.9595049890065447},
    {.m = 0.010492265235399145, .b = 0.9635843460854419},
    {.m = 0.009265109668906035, .b = 0.9672658127849212},
    {.m = 0.008180887722497587, .b = 0.9705862424957971},
    {.m = 0.0072230819664369506, .b = 0.9735793854834865},
    {.m = 0.006377054767430224, .b = 0.9762760971803205},
    {.m = 0.00562984079397566, .b = 0.9787045425940478},
    {.m = 0.004969960978346677, .b = 0.9808903944833188},
    {.m = 0.0043872560495383794, .b = 0.9828570236180468},
    {.m = 0.0038727378358629494, .b = 0.9846256799775561},
    {.m = 0.003418456640227774, .b = 0.9862156641622792},
    {.m = 0.0030173831050053224, .b = 0.9876444886315092},
    {.m = 0.002663303103810577, .b = 0.9889280286358402},
    {.m = 0.0023507243163045644, .b = 0.9900806629147686},
    {.m = 0.0020747932600091445, .b = 0.9911154043758764},
    {.m = 0.0018312216644762458, .b = 0.9920440210838456},
    {.m = 0.001616221179643773, .b = 0.9928771479625714},
    {.m = 0.001426445508677432, .b = 0.9936243896670014},
    {.m = 0.0012589391474531197, .b = 0.9942944151118986},
    {.m = 0.001111091996845559, .b = 0.9948950441612419},
    {.m = 0.0009805991908784506, .b = 0.9954333269858562},
    {.m = 0.0008654255537567934, .b = 0.9959156165913031},
    {.m = 0.0007637741620349914, .b = 0.9963476350061208},
    {.m = 0.0006740585452202907, .b = 0.9967345336036342},
    {.m = 0.0005948781096822842, .b = 0.997080948009113},
    {.m = 0.0005249964164697474, .b = 0.9973910480227436},
    {.m = 0.0004633219853946713, .b = 0.9976685829625814},
    {.m = 0.0004088913340858369, .b = 0.997916922809178},
    {.m = 0.0003608539941470923, .b = 0.9981390955063947},
    {.m = 0.0003184592754550408, .b = 0.9983378207502637},
    {.m = 0.0002810445760577096, .b = 0.998515540572401},
    {.m = 0.0002480250581307075, .b = 0.9986744470024247},
    {.m = 0.0002188845311419385, .b = 0.9988165070714949},
    {.m = 0.0001931674017363605, .b = 0.998943485397935},
    {.m = 0.00017047156594252044, .b = 0.9990569645769042},
    {.m = 0.00015044213376391724, .b = 0.9991583635773084},
    {.m = 0.00013276588905597464, .b = 0.9992489543314366},
    {.m = 0.0001171663986152538, .b = 0.9993298766880978},
    {.m = 0.00010339969473349697, .b = 0.999402151883477},
    {.m = 9.125046395475067e-05, .b = 0.9994666946719891},
    {.m = 8.052868296992699e-05, .b = 0.9995243242447825},
    {.m = 7.106664908640425e-05, .b = 0.9995757740540242},
    {.m = 6.271635921528684e-05, .b = 0.9996217006483153},
    {.m = 5.534719642596997e-05, .b = 0.9996626916163309},
    {.m = 4.884388803283457e-05, .b = 0.9996992727260423},
    {.m = 4.310470343327211e-05, .b = 0.9997319143384523},
    {.m = 3.803986347961086e-05, .b = 0.9997610371681859},
    {.m = 3.357013662252939e-05, .b = 0.9997870174555427},
    {.m = 2.9625599944793635e-05, .b = 0.9998101916085244},
    {.m = 2.6144545634210203e-05, .b = 0.9998308603684934},
    {.m = 2.3072515935140814e-05, .b = 0.9998492925466879},
    {.m = 2.0361451415595866e-05, .b = 0.9998657283753376},
    {.m = 1.7968939269863426e-05, .b = 0.9998803825122302},
    {.m = 1.5857549970021978e-05, .b = 0.999893446733523},
    {.m = 1.39942517520808e-05, .b = 0.9999050923473851},
    {.m = 1.2349893966145942e-05, .b = 0.9999154723559088},
    {.m = 1.0898751067855983e-05, .b = 0.9999247233918854},
    {.m = 9.618120213161774e-06, .b = 0.9999329674530125},
    {.m = 8.487966082881826e-06, .b = 0.9999403134548593},
    {.m = 7.49060751203956e-06, .b = 0.9999468586204805},
    {.m = 6.6104408293909955e-06, .b = 0.999952689724753},
    {.m = 5.8336958232985126e-06, .b = 0.9999578842069813},
    {.m = 5.148220255435376e-06, .b = 0.9999625111670644},
    {.m = 4.543289799485706e-06, .b = 0.9999666322557955},
    {.m = 4.009440246477425e-06, .b = 0.9999703024714724},
    {.m = 3.5383194312288424e-06, .b = 0.9999735708721282},
    {.m = 3.122556586632186e-06, .b = 0.9999764812120404},
    {.m = 2.7556470136858024e-06, .b = 0.9999790725108993},
    {.m = 2.4318503815123904e-06, .b = 0.9999813795619036},
    {.m = 2.1461005843548264e-06, .b = 0.9999834333885707},
    {.m = 1.8939283314978184e-06, .b = 0.9999852616374039},
    {.m = 1.6713832398096429e-06, .b = 0.9999868889983868},
    {.m = 1.4749980170591925e-06, .b = 0.9999883373394046},
    {.m = 1.3016699735857173e-06, .b = 0.999989626466728},
    {.m = 1.1487322808534373e-06, .b = 0.9999907734994234},
    {.m = 1.0137396433407275e-06, .b = 0.9999917943812446},
    {.m = 8.946366261142202e-07, .b = 0.999992702541751},
    {.m = 7.894947575692868e-07, .b = 0.9999935108198654},
    {.m = 6.967641077437747e-07, .b = 0.9999942294824016},
    {.m = 6.147874049844404e-07, .b = 0.9999948699253919},
    {.m = 5.428927511985648e-07, .b = 0.9999954360957904},
    {.m = 0, .b = 1}};

constexpr LinearSegment kTanhDLut255[] = {
    {.m = 0, .b = 0},
    {.m = 1.007787138002053e-05, .b = 8.062297104016424e-05},
    {.m = -1.3584334957977175e-06, .b = -1.0152698911643099e-05},
    {.m = 1.8844996035395073e-06, .b = 1.5385399245637546e-05},
    {.m = 1.2180358306252244e-06, .b = 1.0178651019744711e-05},
    {.m = 1.626020428544755e-06, .b = 1.3340531653621073e-05},
    {.m = 1.7766608589160724e-06, .b = 1.4498579962100575e-05},
    {.m = 2.0308672761724997e-06, .b = 1.6436903893680834e-05},
    {.m = 2.296545463380328e-06, .b = 1.8446095184440038e-05},
    {.m = 2.603593433492354e-06, .b = 2.074895496028023e-05},
    {.m = 2.9499179332380417e-06, .b = 2.3324743427138784e-05},
    {.m = 3.3427852041394806e-06, .b = 2.6222139550036895e-05},
    {.m = 3.7878467215559636e-06, .b = 2.9476651896144925e-05},
    {.m = 4.292198030843418e-06, .b = 3.3133198888478965e-05},
    {.m = 4.863694516979189e-06, .b = 3.724082988257983e-05},
    {.m = 5.511286485320481e-06, .b = 4.1854922657011526e-05},
    {.m = 6.245103476781524e-06, .b = 4.703750515920515e-05},
    {.m = 7.076626301010536e-06, .b = 5.285816492880823e-05},
    {.m = 8.018864486431486e-06, .b = 5.939494234016607e-05},
    {.m = 9.086558959147049e-06, .b = 6.673534184008557e-05},
    {.m = 1.0296414040939728e-05, .b = 7.49774795847982e-05},
    {.m = 1.1667357687287485e-05, .b = 8.423134919764556e-05},
    {.m = 1.3220837955262821e-05, .b = 9.462024848973062e-05},
    {.m = 1.4981159083808095e-05, .b = 0.00010628237596634304},
    {.m = 1.697586008976733e-05, .b = 0.00011937260131795055},
    {.m = 1.9236148188060296e-05, .b = 0.0001340644739568548},
    {.m = 2.1797383339533668e-05, .b = 0.00015055242524446465},
    {.m = 2.469963579074171e-05, .b = 0.00016905428462091592},
    {.m = 2.7988307734865778e-05, .b = 0.00018981402626819908},
    {.m = 3.1714848983928096e-05, .b = 0.00021310490907483856},
    {.m = 3.593755591199048e-05, .b = 0.00023923290819222455},
    {.m = 4.072248893236501e-05, .b = 0.00026854062294201855},
    {.m = 4.614450008288669e-05, .b = 0.00030141156554205624},
    {.m = 5.228840874370994e-05, .b = 0.00033827501750699577},
    {.m = 5.92503232386025e-05, .b = 0.0003796113848204203},
    {.m = 6.713914785408284e-05, .b = 0.0004259582294363673},
    {.m = 7.607828170672819e-05, .b = 0.0004779169449548684},
    {.m = 8.620755134376061e-05, .b = 0.0005361602453678049},
    {.m = 9.768539334720943e-05, .b = 0.00060144047176242},
    {.m = 0.00011069133355813695, .b = 0.0006745988854488873},
    {.m = 0.0001254287901040576, .b = 0.000756575987485571},
    {.m = 0.00014212825425056878, .b = 0.0008484230402913824},
    {.m = 0.00016105088936355506, .b = 0.0009513148687182453},
    {.m = 0.00018249261196310153, .b = 0.0010665641276908077},
    {.m = 0.00020678871162013463, .b = 0.0011956371571187959},
    {.m = 0.00023431908679100773, .b = 0.0013401716267658797},
    {.m = 0.0002655141737300079, .b = 0.0015019961402619431},
    {.m = 0.0003008616633781479, .b = 0.0016831520247086605},
    {.m = 0.0003409141079930337, .b = 0.0018859175255715197},
    {.m = 0.0003862975367158964, .b = 0.0021128346691858335},
    {.m = 0.0004377212117256421, .b = 0.002366739064546453},
    {.m = 0.000495988676264054, .b = 0.002650792954171211},
    {.m = 0.0005620102635706913, .b = 0.0029685218430844026},
    {.m = 0.000636817258806063, .b = 0.0033238550704524183},
    {.m = 0.0007215779308413686, .b = 0.003721170720617913},
    {.m = 0.0008176156770291912, .b = 0.004165345296736593},
    {.m = 0.0009264295587337575, .b = 0.0046618086320136766},
    {.m = 0.0010497175350289607, .b = 0.0052166045253420916},
    {.m = 0.0011894027484183108, .b = 0.005836457659757333},
    {.m = 0.0013476632515790812, .b = 0.006528847361085702},
    {.m = 0.0015269656226395267, .b = 0.007302088836283874},
    {.m = 0.001730102960914857, .b = 0.008165422523954028},
    {.m = 0.0019602378254104814, .b = 0.009129112269029455},
    {.m = 0.002220950735316189, .b = 0.0102045530223905},
    {.m = 0.002516294935187853, .b = 0.011404388834369134},
    {.m = 0.002850858198116594, .b = 0.012742641886084097},
    {.m = 0.003229832538746851, .b = 0.014234853352315736},
    {.m = 0.0036590927925881332, .b = 0.015898236835950704},
    {.m = 0.004145285131123156, .b = 0.01775184512661548},
    {.m = 0.0046959266817587705, .b = 0.01981675094149903},
    {.m = 0.005319517543102531, .b = 0.022116242242704146},
    {.m = 0.00602566660034301, .b = 0.024676032575200887},
    {.m = 0.006825232663644043, .b = 0.027524486675710814},
    {.m = 0.007730482572806965, .b = 0.030692861357781043},
    {.m = 0.008755268009972256, .b = 0.034215561298036726},
    {.m = 0.00991522286359832, .b = 0.038130408929024695},
    {.m = 0.011227983037813458, .b = 0.04247892700611234},
    {.m = 0.012713430637580028, .b = 0.047306631705353694},
    {.m = 0.0143939644098844, .b = 0.05266333310457388},
    {.m = 0.016294798215033546, .b = 0.05860343874566496},
    {.m = 0.01844428905318149, .b = 0.06518625443749304},
    {.m = 0.02087429579618391, .b = 0.0724762746665003},
    {.m = 0.023620569160099414, .b = 0.08054345267300209},
    {.m = 0.02672317260367066, .b = 0.08946343757326942},
    {.m = 0.030226932588664213, .b = 0.09931776253106378},
    {.m = 0.034181914979813155, .b = 0.11019396410672339},
    {.m = 0.038643922061500635, .b = 0.12218560813875848},
    {.m = 0.043675001669719826, .b = 0.13539219211033388},
    {.m = 0.049343955955897856, .b = 0.14991888746866505},
    {.m = 0.055726832244054225, .b = 0.16587607818905598},
    {.m = 0.06290737189520268, .b = 0.18337864358873035},
    {.m = 0.07097738488934113, .b = 0.20254492444980918},
    {.m = 0.08003700757848264, .b = 0.2234953019184489},
    {.m = 0.09019478837513628, .b = 0.2463503087109196},
    {.m = 0.1015675308321572, .b = 0.27122818283565286},
    {.m = 0.11427980508710467, .b = 0.2982417656274162},
    {.m = 0.12846301715792374, .b = 0.3274946405234806},
    {.m = 0.14425390069712063, .b = 0.3590764076018743},
    {.m = 0.1617922683934454, .b = 0.3930569950135036},
    {.m = 0.1812178306071306, .b = 0.4294799241641633},
    {.m = 0.20266585938914838, .b = 0.46835447633157057},
    {.m = 0.22626144884800814, .b = 0.5096467578845751},
    {.m = 0.2521121030407203, .b = 0.5532697368347769},
    {.m = 0.2802983755783557, .b = 0.5990724297084344},
    {.m = 0.31086230062948284, .b = 0.6468285626008206},
    {.m = 0.34379340331355124, .b = 0.6962252166269232},
    {.m = 0.379012174238353, .b = 0.7468521998313257},
    {.m = 0.41635105351913504, .b = 0.798193158842401},
    {.m = 0.45553321382998746, .b = 0.8496197442503948},
    {.m = 0.49614977519242576, .b = 0.9003904459534426},
    {.m = 0.5376365400758507, .b = 0.9496559792525098},
    {.m = 0.5792519043475783, .b = 0.9964732640582035},
    {.m = 0.6200582601646234, .b = 1.0398300171138137},
    {.m = 0.6589099114876911, .b = 1.0786816684368814},
    {.m = 0.6944511755801042, .b = 1.1120016035235187},
    {.m = 0.7251288415606236, .b = 1.1388445612564733},
    {.m = 0.7492231822945818, .b = 1.1584212131028142},
    {.m = 0.7649015622658641, .b = 1.170179998081276},
    {.m = 0.7702962220999048, .b = 1.173888826717179},
    {.m = 0.7636100462143496, .b = 1.169709966788707},
    {.m = 0.7432342899071447, .b = 1.1582486038659043},
    {.m = 0.7079202887183982, .b = 1.140591603271531},
    {.m = 0.6568112776840263, .b = 1.1182314109439933},
    {.m = 0.5900008594121253, .b = 1.0931775040920304},
    {.m = 0.5070564530895272, .b = 1.0672573771162184},
    {.m = 0.4129848264445979, .b = 1.043739470454986},
    {.m = 0.2961887320308385, .b = 1.0218402027524063},
    {.m = 0.2106592109314267, .b = 1.0111490126149798},
    {.m = 0.0, .b = 0.9979828119317656},
    {.m = -0.2106592109314267, .b = 1.0111490126149798},
    {.m = -0.2961887320308385, .b = 1.0218402027524063},
    {.m = -0.4129848264445979, .b = 1.043739470454986},
    {.m = -0.5070564530895272, .b = 1.0672573771162184},
    {.m = -0.5900008594121253, .b = 1.0931775040920304},
    {.m = -0.6568112776840263, .b = 1.1182314109439933},
    {.m = -0.7079202887183982, .b = 1.140591603271531},
    {.m = -0.7432342899071447, .b = 1.1582486038659043},
    {.m = -0.7636100462143496, .b = 1.169709966788707},
    {.m = -0.7702962220999048, .b = 1.173888826717179},
    {.m = -0.7649015622658641, .b = 1.170179998081276},
    {.m = -0.7492231822945818, .b = 1.1584212131028142},
    {.m = -0.7251288415606201, .b = 1.1388445612564704},
    {.m = -0.6944511755801095, .b = 1.1120016035235236},
    {.m = -0.6589099114876893, .b = 1.0786816684368796},
    {.m = -0.6200582601646216, .b = 1.039830017113812},
    {.m = -0.579251904347581, .b = 0.9964732640582064},
    {.m = -0.5376365400758498, .b = 0.9496559792525088},
    {.m = -0.49614977519242665, .b = 0.9003904459534438},
    {.m = -0.45553321382998746, .b = 0.8496197442503948},
    {.m = -0.41635105351913326, .b = 0.7981931588423986},
    {.m = -0.37901217423835387, .b = 0.746852199831327},
    {.m = -0.34379340331355124, .b = 0.6962252166269232},
    {.m = -0.31086230062948284, .b = 0.6468285626008206},
    {.m = -0.2802983755783557, .b = 0.5990724297084344},
    {.m = -0.2521121030407203, .b = 0.5532697368347769},
    {.m = -0.22626144884800814, .b = 0.5096467578845751},
    {.m = -0.20266585938914816, .b = 0.4683544763315702},
    {.m = -0.18121783060713081, .b = 0.42947992416416375},
    {.m = -0.16179226839344585, .b = 0.39305699501350444},
    {.m = -0.14425390069711952, .b = 0.35907640760187215},
    {.m = -0.1284630171579244, .b = 0.32749464052348193},
    {.m = -0.11427980508710467, .b = 0.2982417656274162},
    {.m = -0.10156753083215686, .b = 0.27122818283565214},
    {.m = -0.09019478837513661, .b = 0.24635030871092034},
    {.m = -0.08003700757848287, .b = 0.2234953019184494},
    {.m = -0.0709773848893408, .b = 0.2025449244498084},
    {.m = -0.06290737189520285, .b = 0.18337864358873074},
    {.m = -0.05572683224405417, .b = 0.16587607818905586},
    {.m = -0.0493439559558978, .b = 0.1499188874686649},
    {.m = -0.04367500166971988, .b = 0.13539219211033401},
    {.m = -0.03864392206150069, .b = 0.12218560813875863},
    {.m = -0.034181914979813155, .b = 0.11019396410672339},
    {.m = -0.0302269325886641, .b = 0.09931776253106347},
    {.m = -0.026723172603670686, .b = 0.08946343757326951},
    {.m = -0.02362056916009947, .b = 0.08054345267300225},
    {.m = -0.02087429579618394, .b = 0.07247627466650039},
    {.m = -0.01844428905318149, .b = 0.06518625443749304},
    {.m = -0.016294798215033504, .b = 0.05860343874566483},
    {.m = -0.014393964409884344, .b = 0.052663333104573704},
    {.m = -0.012713430637580056, .b = 0.047306631705353784},
    {.m = -0.01122798303781343, .b = 0.04247892700611225},
    {.m = -0.009915222863598375, .b = 0.03813040892902488},
    {.m = -0.008755268009972256, .b = 0.034215561298036726},
    {.m = -0.0077304825728069446, .b = 0.03069286135778097},
    {.m = -0.006825232663644043, .b = 0.027524486675710814},
    {.m = -0.00602566660034301, .b = 0.024676032575200884},
    {.m = -0.00531951754310258, .b = 0.022116242242704327},
    {.m = -0.004695926681758729, .b = 0.019816750941498873},
    {.m = -0.004145285131123146, .b = 0.01775184512661544},
    {.m = -0.0036590927925881436, .b = 0.015898236835950742},
    {.m = -0.0032298325387468477, .b = 0.014234853352315722},
    {.m = -0.002850858198116594, .b = 0.012742641886084097},
    {.m = -0.002516294935187853, .b = 0.011404388834369134},
    {.m = -0.002220950735316196, .b = 0.010204553022390529},
    {.m = -0.0019602378254104796, .b = 0.009129112269029448},
    {.m = -0.0017301029609148554, .b = 0.008165422523954021},
    {.m = -0.0015269656226395267, .b = 0.007302088836283874},
    {.m = -0.001347663251579083, .b = 0.006528847361085711},
    {.m = -0.001189402748418309, .b = 0.005836457659757325},
    {.m = -0.0010497175350289625, .b = 0.005216604525342099},
    {.m = -0.0009264295587337584, .b = 0.004661808632013681},
    {.m = -0.0008176156770291895, .b = 0.004165345296736585},
    {.m = -0.0007215779308413651, .b = 0.0037211707206178967},
    {.m = -0.0006368172588060673, .b = 0.0033238550704524387},
    {.m = -0.0005620102635706913, .b = 0.0029685218430844026},
    {.m = -0.0004959886762640493, .b = 0.0026507929541711877},
    {.m = -0.000437721211725646, .b = 0.002366739064546472},
    {.m = -0.000386297536715896, .b = 0.0021128346691858314},
    {.m = -0.0003409141079930337, .b = 0.0018859175255715199},
    {.m = -0.0003008616633781475, .b = 0.0016831520247086583},
    {.m = -0.0002655141737300079, .b = 0.0015019961402619431},
    {.m = -0.00023431908679100817, .b = 0.001340171626765882},
    {.m = -0.00020678871162013376, .b = 0.0011956371571187913},
    {.m = -0.00018249261196310197, .b = 0.0010665641276908098},
    {.m = -0.00016105088936355463, .b = 0.000951314868718243},
    {.m = -0.0001421282542505692, .b = 0.0008484230402913849},
    {.m = -0.0001254287901040575, .b = 0.0007565759874855703},
    {.m = -0.00011069133355813717, .b = 0.0006745988854488885},
    {.m = -9.768539334720932e-05, .b = 0.0006014404717624193},
    {.m = -8.620755134376018e-05, .b = 0.0005361602453678024},
    {.m = -7.607828170672851e-05, .b = 0.0004779169449548703},
    {.m = -6.713914785408295e-05, .b = 0.00042595822943636795},
    {.m = -5.925032323860239e-05, .b = 0.0003796113848204197},
    {.m = -5.22884087437101e-05, .b = 0.00033827501750699674},
    {.m = -4.614450008288642e-05, .b = 0.00030141156554205467},
    {.m = -4.072248893236517e-05, .b = 0.00026854062294201953},
    {.m = -3.5937555911990586e-05, .b = 0.00023923290819222523},
    {.m = -3.171484898392807e-05, .b = 0.00021310490907483842},
    {.m = -2.7988307734865778e-05, .b = 0.00018981402626819908},
    {.m = -2.4699635790741657e-05, .b = 0.00016905428462091557},
    {.m = -2.179738333953375e-05, .b = 0.00015055242524446516},
    {.m = -1.923614818806016e-05, .b = 0.00013406447395685392},
    {.m = -1.6975860089767954e-05, .b = 0.0001193726013179546},
    {.m = -1.4981159083805398e-05, .b = 0.00010628237596632532},
    {.m = -1.3220837955273121e-05, .b = 9.462024848979898e-05},
    {.m = -1.166735768724939e-05, .b = 8.423134919739027e-05},
    {.m = -1.029641404107913e-05, .b = 7.497747958574103e-05},
    {.m = -9.086558958637663e-06, .b = 6.673534183660854e-05},
    {.m = -8.018864488293874e-06, .b = 5.939494235299499e-05},
    {.m = -7.076626294188594e-06, .b = 5.28581648813896e-05},
    {.m = -6.245103501841421e-06, .b = 4.7037505334959394e-05},
    {.m = -5.511286392971867e-06, .b = 4.185492200356817e-05},
    {.m = -4.863694858339559e-06, .b = 3.7240832319312975e-05},
    {.m = -4.292196765639703e-06, .b = 3.3133189778032755e-05},
    {.m = -3.787851420987949e-06, .b = 2.947668602930754e-05},
    {.m = -3.3427677203715885e-06, .b = 2.6222011468550407e-05},
    {.m = -2.9499830547129454e-06, .b = 2.3325224559317912e-05},
    {.m = -2.6033506888727897e-06, .b = 2.0747146338381757e-05},
    {.m = -2.297450760501792e-06, .b = 1.8452896875599272e-05},
    {.m = -2.0274900031586365e-06, .b = 1.6411318648191657e-05},
    {.m = -1.7892623188203055e-06, .b = 1.4594832555111885e-05},
    {.m = -1.578996194229839e-06, .b = 1.2978411722322675e-05},
    {.m = -1.3935243684285019e-06, .b = 1.1541005072362311e-05},
    {.m = -1.2295764782459645e-06, .b = 1.0260162180311239e-05},
    {.m = -1.0857842042981909e-06, .b = 9.127798022972522e-06},
    {.m = 0, .b = 0}};

// Defines piecewise linear functions with segments defined on [-8, 8].
inline float LutFn255(float x, const LinearSegment lut[]) {
  int i = static_cast<int>(x * 16.f) + 128;
  i = i > 255 ? 255 : (i < 0 ? 0 : i);
  const auto& segment = lut[i];
  return segment.m * x + segment.b;
}

}  // namespace

float FastSwish(float x) {
  return LutFn255(x, kSwishLut255);
}

float FastSwishD(float x) {
  return LutFn255(x, kSwishDLut255);
}

float FastSigmoid(float x) {
  return LutFn255(x, kSigmoidLut255);
}

float FastSigmoidD(float x) {
  return LutFn255(x, kSigmoidDLut255);
}

float FastTanh(float x) {
  return LutFn255(x, kTanhLut255);
}

float FastTanhD(float x) {
  return LutFn255(x, kTanhDLut255);
}

}  // namespace nn
}  // namespace azah
